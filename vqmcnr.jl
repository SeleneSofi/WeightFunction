# Program to run VQMC simulation for Ne atom and optimize boys parâmeters using
# Newton-Raphson method.
#
# v 1.4.9 (1 - features added, 2 - revision, 3 - atom added)
#
### Matrix of ψ are transposed, Slater determinant has rows for electrons and
### columns for orbitals.
#
# Loading packages.
using JLD
using Printf
using Random
using LinearAlgebra
using Plots
gr()
default(legend = false)

# Setting general auxiliar functions
function dfact(n::Int)
    n ≥ -1 || error("n must be greater than -2")
    -1 ≤ n ≤ 0 && return 1
    n * dfact(n-2)
end

function sumd(A::AbstractArray, dims)
    return dropdims(sum(A, dims=dims), dims=dims)
end

function prodd(A::AbstractArray, dims)
    return dropdims(prod(A, dims=dims), dims=dims)
end

function printprg(en::Float64, σen::Float64, acc::Float64, τr::Float64, ict::Int, nrun::Int)
    pct = round(100ict/nrun, digits=1)
    pi = convert(Int,round(50ict/nrun))
    if ict == 100
        @printf("E = %.8f ± %.8f Eh\n", en, σen)
        # println("E = $en ± $σen")
        @printf("Step = %i\n", ict)
        # println("Step = $ict")
        @printf("Acceptance = %.4f\n", acc)
        # println("Acceptance = $acc")
        @printf("τ = %.4f\n", τr)
        # println("τ = $τr")
        println("[" * "="^pi * " "^(50-pi) * "] $(@sprintf("%5.1f",pct)) %")
        # println("[" * " "^50 * "] $(@sprintf("%5.1f",pct)) %")
    else
        # pi = convert(Int,round(50ict/nrun))
        print("\u1b[5F")
        @printf("E = %.8f ± %.8f Eh\n", en, σen)
        # println("E = $en ± $σen")
        @printf("Step = %i\n", ict)
        # println("Step = $ict")
        @printf("Acceptance = %.4f\n", acc)
        # println("Acceptance = $acc")
        @printf("τ = %.4f\n", τr)
        # println("τ = $τr")
        println("[" * "="^pi * " "^(50-pi) * "] $(@sprintf("%5.1f",pct)) %")
        # println("[" * "="^pi * " "^(50-pi) * "] $pct %")
        print("\u1b[0K")
    end
end

# Setting structures
struct QMCstr
    nw::Int
    seed::Int
    tnstp::Int
    nstp::Int
    τ::Float64
    acc::Float64
    nrstp::Int
    Δlim::Float64
end

struct STOstr
    base::String
    zn::Int
    nα::Int
    nβ::Int
    ne::Int
    np::Int
    ep::Array{Int,2}
    ζ::Array{Float64,1}
    # iap::Array{Int,1}
    cαp::Array{Float64,2}
    cβp::Array{Float64,2}
end

struct Corstr
    c9::Array{Float64,1}
    c9i::BitArray{1}
end

mutable struct Ψstr
    ψ::Array{Float64,1}
    ψs::Array{Array{Float64,3},1}
    ∇ψs::Array{Array{Float64,4},1}
    ∇²ψs::Array{Array{Float64,3},1}
    ψ⁻¹s::Array{Array{Float64,3},1}
end

struct NRstr
    E::Array{Float64,1}
    σ::Array{Float64,1}
    Ek::Array{Float64,1}
    Vne::Array{Float64,1}
    Vee::Array{Float64,1}
    Vt::Array{Float64,1}
    c9::Array{Float64,2}
    fm::Array{Float64,2}
    hmn::Array{Float64,3}
end

struct NRμstr
    μ∂lψ∂m::Array{Float64,2}
    μ∂el∂m::Array{Float64,2}
    μel∂lψ∂m::Array{Float64,2}
    μ∂²lψ∂mn::Array{Float64,3}
    μel∂²lψ∂mn::Array{Float64,3}
    μ∂el∂m∂lψ∂n::Array{Float64,3}
end

# Setting especific auxiliar functions
function qmcinp(iask::Bool, icor::Bool, atom::Int, ion::Int, spin::Char, base::String)
    if iask
        println("Enter number of thermalization steps:")
        tnstp = parse(Int,readline())
        println("Enter number of VQMC steps:")
        nstp = parse(Int,readline())
        println("Enter number of NR steps:")
        nrstp = parse(Int,readline())
        println("Enter seed number:")
        seed = parse(Int,readline())
        Random.seed!(seed)
        qmcp = QMCstr(
            100, # nw
            seed, # seed
            tnstp, # tnstp
            nstp, # nstp
            1., # τ
            .50, # acc
        nrstp, # nrstp
        1. # Δlim
        )
    end
    # atom = 10
    # ion = 0
    # spin = 'α'
    # spin = 'β'
    # spin = 'n'
    _base = base
    if base == "hf"
        if atom == 2 # He
            _zn = 2
            _nα = 1
            _nβ = 1
            _ne = 2
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;]
            _ζ = [  1.382246;
                    1.790019;
                    2.663009;
                    3.745013;
                    7.575002;]
            _cαp = [ 0.6355091  0.2343731  0.1134974  0.0426666 -0.0009523;]
            _cβp = [ 0.6355091  0.2343731  0.1134974  0.0426666 -0.0009523;]
        elseif atom == 3 # Li
            _zn = 3
            _nα = 2
            _nβ = 1
            _ne = 3
            _np = 6
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;]
            _ζ = [  2.474337;
                    4.691814;
                    0.537980;
                    0.676251;
                    1.479280;
                    1.476199;]
            _cαp = [ 0.8976116  0.1121439  0.0002822  0.0002548  0.0090043 -0.0027424;
                    -0.1456155 -0.0155569  0.0617371  0.9644787 -0.1043327  0.0674222;]
            _cβp = [ 0.8976116  0.1121439  0.0002822  0.0002548  0.0090043 -0.0027424;]
        elseif atom == 4 # Be
            _zn = 4
            _nα = 2
            _nβ = 2
            _ne = 4
            _np = 6
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;]
            _ζ = [  3.458896;
                    6.355226;
                    0.827346;
                    1.112752;
                    2.220399;
                    2.220437;]
            _cαp = [ 0.9197828  0.0887647  0.0007337 -0.0017839  0.0024317  0.0020705;
                    -0.1733382 -0.0139724  0.5236399  0.4678289 -0.0963852  0.1219893;]
            _cβp = [ 0.9197828  0.0887647  0.0007337 -0.0017839  0.0024317  0.0020705;
                    -0.1733382 -0.0139724  0.5236399  0.4678289 -0.0963852  0.1219893;]
        elseif atom == 5 # B
            _zn = 5
            _nα = 3
            _nβ = 2
            _ne = 5
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  4.450646;
                    7.978462;
                    1.070984;
                    1.513458;
                    2.984970;
                    2.984707;
                    0.867063;
                    0.867063;
                    0.867063;
                    1.318028;
                    1.318028;
                    1.318028;
                    2.225976;
                    2.225976;
                    2.225976;
                    5.588930;
                    5.588930;
                    5.588930;]
            _cαp = [ 0.9301401  0.0749947  0.0006031 -0.0012172  0.0036609  0.0027596  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1946677 -0.0123621  0.4868169  0.5129629 -0.1018093  0.1264200  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5073472  0.0000000  0.0000000  0.4081927  0.0000000  0.0000000  0.1402545  0.0000000  0.0000000  0.0086480  0.0000000  0.0000000;]
            _cβp = [ 0.9301401  0.0749947  0.0006031 -0.0012172  0.0036609  0.0027596  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1946677 -0.0123621  0.4868169  0.5129629 -0.1018093  0.1264200  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 6 # C
            _zn = 6
            _nα = 4
            _nβ = 2
            _ne = 6
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  5.450236;
                    9.584061;
                    1.304429;
                    1.899079;
                    3.753271;
                    3.753486;
                    1.058381;
                    1.058381;
                    1.058381;
                    1.648879;
                    1.648879;
                    1.648879;
                    2.808762;
                    2.808762;
                    2.808762;
                    6.781327;
                    6.781327;
                    6.781327;]
            _cαp = [ 0.9358190  0.0652831  0.0004788 -0.0005269  0.0075836  0.0020628  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2070314 -0.0106959  0.4706099  0.5355402 -0.1035593  0.1263419  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4487862  0.0000000  0.0000000  0.4485854  0.0000000  0.0000000  0.1654066  0.0000000  0.0000000  0.0084335  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4487862  0.0000000  0.0000000  0.4485854  0.0000000  0.0000000  0.1654066  0.0000000  0.0000000  0.0084335  0.0000000;]
            _cβp = [ 0.9358190  0.0652831  0.0004788 -0.0005269  0.0075836  0.0020628  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2070314 -0.0106959  0.4706099  0.5355402 -0.1035593  0.1263419  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 7 # N
            _zn = 7
            _nα = 5
            _nβ = 2
            _ne = 7
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  6.456000;
                   11.177296;
                    1.532766;
                    2.276793;
                    4.522349;
                    4.522246;
                    1.241379;
                    1.241379;
                    1.241379;
                    1.970995;
                    1.970995;
                    1.970995;
                    3.381653;
                    3.381653;
                    3.381653;
                    7.900632;
                    7.900632;
                    7.900632;]
            _cαp = [ 0.9392278  0.0579237  0.0003903  0.0000567  0.0121356  0.0010283  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2152015 -0.0092047  0.4597820  0.5508021 -0.1043844  0.1257279  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4151506  0.0000000  0.0000000  0.4694568  0.0000000  0.0000000  0.1830251  0.0000000  0.0000000  0.0083113  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4151506  0.0000000  0.0000000  0.4694568  0.0000000  0.0000000  0.1830251  0.0000000  0.0000000  0.0083113  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4151506  0.0000000  0.0000000  0.4694568  0.0000000  0.0000000  0.1830251  0.0000000  0.0000000  0.0083113;]
            _cβp = [ 0.9392278  0.0579237  0.0003903  0.0000567  0.0121356  0.0010283  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2152015 -0.0092047  0.4597820  0.5508021 -0.1043844  0.1257279  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 8 # O
            _zn = 8
            _nα = 5
            _nβ = 3
            _ne = 8
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  7.464747;
                   12.762564;
                    1.758323;
                    2.646902;
                    5.281110;
                    5.281123;
                    1.342923;
                    1.342923;
                    1.342923;
                    2.228226;
                    2.228226;
                    2.228226;
                    3.902971;
                    3.902971;
                    3.902971;
                    8.950772;
                    8.950772;
                    8.950772;]
            _cαp = [ 0.9417807  0.0521187  0.0003666  0.0004481  0.0160922 -0.0000090  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2224276 -0.0079414  0.4366327  0.5761600 -0.1063067  0.1273848  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3909221  0.0000000  0.0000000  0.4763554  0.0000000  0.0000000  0.2129036  0.0000000  0.0000000  0.0080552  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3909221  0.0000000  0.0000000  0.4763554  0.0000000  0.0000000  0.2129036  0.0000000  0.0000000  0.0080552  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3909221  0.0000000  0.0000000  0.4763554  0.0000000  0.0000000  0.2129036  0.0000000  0.0000000  0.0080552;]
            _cβp = [ 0.9417807  0.0521187  0.0003666  0.0004481  0.0160922 -0.0000090  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2224276 -0.0079414  0.4366327  0.5761600 -0.1063067  0.1273848  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3909221  0.0000000  0.0000000  0.4763554  0.0000000  0.0000000  0.2129036  0.0000000  0.0000000  0.0080552  0.0000000  0.0000000;]
        elseif atom == 9 # F
            _zn = 9
            _nα = 5
            _nβ = 4
            _ne = 9
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 14.336039;
                    8.476794;
                    1.981288;
                    3.013404;
                    6.039343;
                    6.039028;
                    1.472790;
                    1.472790;
                    1.472790;
                    2.503221;
                    2.503221;
                    2.503221;
                    4.437019;
                    4.437019;
                    4.437019;
                    9.878804;
                    9.878804;
                    9.878804;]
            _cαp = [ 0.0474454  0.9434744  0.0003394  0.0007807  0.0198715 -0.0009803  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0068148 -0.2275922  0.4223467  0.5917701 -0.1072497  0.1284999  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3735753  0.0000000  0.0000000  0.4831104  0.0000000  0.0000000  0.2298599  0.0000000  0.0000000  0.0082664  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3735753  0.0000000  0.0000000  0.4831104  0.0000000  0.0000000  0.2298599  0.0000000  0.0000000  0.0082664  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3735753  0.0000000  0.0000000  0.4831104  0.0000000  0.0000000  0.2298599  0.0000000  0.0000000  0.0082664;]
            _cβp = [ 0.0474454  0.9434744  0.0003394  0.0007807  0.0198715 -0.0009803  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0068148 -0.2275922  0.4223467  0.5917701 -0.1072497  0.1284999  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3735753  0.0000000  0.0000000  0.4831104  0.0000000  0.0000000  0.2298599  0.0000000  0.0000000  0.0082664  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3735753  0.0000000  0.0000000  0.4831104  0.0000000  0.0000000  0.2298599  0.0000000  0.0000000  0.0082664  0.0000000;]
        elseif atom == 10 # Ne
            _zn = 10
            _nα = 5
            _nβ = 5
            _ne = 10
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  9.518262;
                   15.968781;
                    2.194510;
                    3.337710;
                    5.949091;
                    7.493535;
                    1.615507;
                    1.615507;
                    1.615507;
                    2.783599;
                    2.783599;
                    2.783599;
                    4.968252;
                    4.968252;
                    4.968252;
                   10.715313;
                   10.715313;
                   10.715313;]
            _cαp = [ 0.9432080  0.0421261  0.0003350  0.0008688  0.0040885  0.0210904  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2302108 -0.0059093  0.4021701  0.5976338  0.2457254 -0.2215880  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627;]
            _cβp = [ 0.9432080  0.0421261  0.0003350  0.0008688  0.0040885  0.0210904  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2302108 -0.0059093  0.4021701  0.5976338  0.2457254 -0.2215880  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3599841  0.0000000  0.0000000  0.4881067  0.0000000  0.0000000  0.2417839  0.0000000  0.0000000  0.0087627;]
        elseif atom == 11 # Na
            _zn = 11
            _nα = 6
            _nβ = 5
            _ne = 11
            _np = 23
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 11.018722;
                   13.159940;
                    7.293525;
                    9.016438;
                    4.659763;
                    3.083452;
                    1.146482;
                    0.717591;
                    5.532319;
                    5.532319;
                    5.532319;
                    8.457180;
                    8.457180;
                    8.457180;
                    5.333835;
                    5.333835;
                    5.333835;
                    3.494757;
                    3.494757;
                    3.494757;
                    2.293918;
                    2.293918;
                    2.293918;]
            _cαp = [ 0.9610744  0.0339029 -0.0066419  0.0297862  0.0021956 -0.0001046  0.0000385 -0.0000196  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2346283 -0.0024932  0.2642810  0.0008830  0.5222613  0.3133262  0.0014911 -0.0002404  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554;
                     0.0352574  0.0005415 -0.0412229 -0.0009886 -0.0879278 -0.0525404  0.3813198  0.6755197  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9610744  0.0339029 -0.0066419  0.0297862  0.0021956 -0.0001046  0.0000385 -0.0000196  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2346283 -0.0024932  0.2642810  0.0008830  0.5222613  0.3133262  0.0014911 -0.0002404  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.4674001  0.0000000  0.0000000  0.0402879  0.0000000  0.0000000  0.3019790  0.0000000  0.0000000  0.3050942  0.0000000  0.0000000  0.0696554;]
        elseif atom == 12 # Mg
            _zn = 12
            _nα = 6
            _nβ = 6
            _ne = 12
            _np = 23
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 12.018892;
                   14.423157;
                    9.700213;
                    5.417902;
                    8.710066;
                    3.633392;
                    1.459892;
                    0.886562;
                    6.034434;
                    6.034434;
                    6.034434;
                    9.315954;
                    9.315954;
                    9.315954;
                    5.864442;
                    5.864442;
                    5.864442;
                    3.907320;
                    3.907320;
                    3.907320;
                    2.504457;
                    2.504457;
                    2.504457;]
            _cαp = [ 0.9635511  0.0304620  0.0407748  0.0022355 -0.0178322 -0.0000748  0.0000304 -0.0000125  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2434248 -0.0009513 -0.0800851  0.5313031  0.2963763  0.3457208  0.0016843 -0.0004511  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190;
                     0.0468904  0.0002375  0.0172343 -0.1105303 -0.0627532 -0.0902749  0.4865318  0.5940928  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9635511  0.0304620  0.0407748  0.0022355 -0.0178322 -0.0000748  0.0000304 -0.0000125  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2434248 -0.0009513 -0.0800851  0.5313031  0.2963763  0.3457208  0.0016843 -0.0004511  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5031846  0.0000000  0.0000000  0.0378624  0.0000000  0.0000000  0.3021278  0.0000000  0.0000000  0.2843927  0.0000000  0.0000000  0.0373190;
                     0.0468904  0.0002375  0.0172343 -0.1105303 -0.0627532 -0.0902749  0.4865318  0.5940928  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 13 # Al
            _zn = 13
            _nα = 7
            _nβ = 6
            _ne = 13
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 4;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 13.019114;
                   15.769007;
                   10.437743;
                    6.158408;
                    4.173625;
                    1.763155;
                    1.096749;
                   10.437293;
                    6.563891;
                    6.563891;
                    6.563891;
                   11.134920;
                   11.134920;
                   11.134920;
                    7.067567;
                    7.067567;
                    7.067567;
                    5.052673;
                    5.052673;
                    5.052673;
                    3.559202;
                    3.559202;
                    3.559202;
                    2.109381;
                    2.109381;
                    2.109381;
                    1.300855;
                    1.300855;
                    1.300855;
                    0.849565;
                    0.849565;
                    0.849565;]
            _cαp = [ 0.9656944  0.0264372  0.0326149  0.0018754  0.0000229  0.0000085 -0.0000052 -0.0090913  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2509799  0.0005549  0.1160016  0.5344679  0.3711652  0.0023192 -0.0004419  0.0703943  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420;
                     0.0579439 -0.0003261 -0.0289677 -0.1290084 -0.1299222  0.5607677  0.5330230 -0.0196251  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0950639  0.0000000  0.0000000 -0.0040213  0.0000000  0.0000000 -0.0316865  0.0000000  0.0000000 -0.0493038  0.0000000  0.0000000  0.0220340  0.0000000  0.0000000  0.2947533  0.0000000  0.0000000  0.5191978  0.0000000  0.0000000  0.2904751  0.0000000  0.0000000;]
            _cβp = [ 0.9656944  0.0264372  0.0326149  0.0018754  0.0000229  0.0000085 -0.0000052 -0.0090913  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2509799  0.0005549  0.1160016  0.5344679  0.3711652  0.0023192 -0.0004419  0.0703943  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5292691  0.0000000  0.0000000  0.0209520  0.0000000  0.0000000  0.1997186  0.0000000  0.0000000  0.2984470  0.0000000  0.0000000  0.0987179  0.0000000  0.0000000  0.0027992  0.0000000  0.0000000  0.0003848  0.0000000  0.0000000  0.0000420;
                     0.0579439 -0.0003261 -0.0289677 -0.1290084 -0.1299222  0.5607677  0.5330230 -0.0196251  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 14 # Si
            _zn = 14
            _nα = 8
            _nβ = 6
            _ne = 14
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 4;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 14.018917;
                   16.871773;
                   10.288924;
                   11.190996;
                    4.729907;
                    2.062735;
                    1.290755;
                    7.741146;
                    7.060963;
                    7.060963;
                    7.060963;
                   11.878058;
                   11.878058;
                   11.878058;
                    7.467428;
                    7.467428;
                    7.467428;
                    5.342720;
                    5.342720;
                    5.342720;
                    3.723624;
                    3.723624;
                    3.723624;
                    2.406136;
                    2.406136;
                    2.406136;
                    1.535911;
                    1.535911;
                    1.535911;
                    1.023110;
                    1.023110;
                    1.023110;]
            _cαp = [ 0.9676134  0.0259357 -0.0272677  0.0492351 -0.0001117  0.0000170 -0.0000120  0.0019515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2575025  0.0004700  0.5742043 -0.2171883  0.4113784  0.0032202 -0.0004206  0.3376858  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253;
                     0.0659539 -0.0001400 -0.1629429  0.0633070 -0.1676484  0.5934337  0.5132401 -0.0874774  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1190658  0.0000000  0.0000000 -0.0048872  0.0000000  0.0000000 -0.0409056  0.0000000  0.0000000 -0.0521993  0.0000000  0.0000000  0.0498018  0.0000000  0.0000000  0.3412966  0.0000000  0.0000000  0.5044180  0.0000000  0.0000000  0.2336623  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1190658  0.0000000  0.0000000 -0.0048872  0.0000000  0.0000000 -0.0409056  0.0000000  0.0000000 -0.0521993  0.0000000  0.0000000  0.0498018  0.0000000  0.0000000  0.3412966  0.0000000  0.0000000  0.5044180  0.0000000  0.0000000  0.2336623  0.0000000;]
            _cβp = [ 0.9676134  0.0259357 -0.0272677  0.0492351 -0.0001117  0.0000170 -0.0000120  0.0019515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2575025  0.0004700  0.5742043 -0.2171883  0.4113784  0.0032202 -0.0004206  0.3376858  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5574337  0.0000000  0.0000000  0.0218633  0.0000000  0.0000000  0.2203488  0.0000000  0.0000000  0.2810136  0.0000000  0.0000000  0.0560706  0.0000000  0.0000000  0.0004232  0.0000000  0.0000000  0.0008229  0.0000000  0.0000000 -0.0000253;
                     0.0659539 -0.0001400 -0.1629429  0.0633070 -0.1676484  0.5934337  0.5132401 -0.0874774  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 15 # P
            _zn = 15
            _nα = 9
            _nβ = 6
            _ne = 15
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 4;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 15.019010;
                   18.499912;
                   13.099535;
                    7.583922;
                    5.216682;
                    2.357875;
                    1.477867;
                   13.101919;
                    7.561061;
                    7.561061;
                    7.561061;
                   12.743796;
                   12.743796;
                   12.743796;
                    7.941036;
                    7.941036;
                    7.941036;
                    5.686571;
                    5.686571;
                    5.686571;
                    3.762222;
                    3.762222;
                    3.762222;
                    2.565476;
                    2.565476;
                    2.565476;
                    1.699577;
                    1.699577;
                    1.699577;
                    1.165542;
                    1.165542;
                    1.165542;]
            _cαp = [ 0.9692788  0.0197761  0.0294689  0.0011132  0.0001955 -0.0000464  0.0000091 -0.0036057  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2631624  0.0042018  0.0694109  0.5391227  0.4017991  0.0041471 -0.0003938  0.0723857  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751;
                     0.0722880 -0.0015885 -0.0205625 -0.1525625 -0.1848702  0.6108720  0.5074913 -0.0242294  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1382345  0.0000000  0.0000000 -0.0052089  0.0000000  0.0000000 -0.0472358  0.0000000  0.0000000 -0.0499691  0.0000000  0.0000000  0.1087737  0.0000000  0.0000000  0.3834723  0.0000000  0.0000000  0.4605186  0.0000000  0.0000000  0.1774474  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1382345  0.0000000  0.0000000 -0.0052089  0.0000000  0.0000000 -0.0472358  0.0000000  0.0000000 -0.0499691  0.0000000  0.0000000  0.1087737  0.0000000  0.0000000  0.3834723  0.0000000  0.0000000  0.4605186  0.0000000  0.0000000  0.1774474  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1382345  0.0000000  0.0000000 -0.0052089  0.0000000  0.0000000 -0.0472358  0.0000000  0.0000000 -0.0499691  0.0000000  0.0000000  0.1087737  0.0000000  0.0000000  0.3834723  0.0000000  0.0000000  0.4605186  0.0000000  0.0000000  0.1774474;]
            _cβp = [ 0.9692788  0.0197761  0.0294689  0.0011132  0.0001955 -0.0000464  0.0000091 -0.0036057  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2631624  0.0042018  0.0694109  0.5391227  0.4017991  0.0041471 -0.0003938  0.0723857  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.5817390  0.0000000  0.0000000  0.0212759  0.0000000  0.0000000  0.2314258  0.0000000  0.0000000  0.2622905  0.0000000  0.0000000  0.0319969  0.0000000  0.0000000 -0.0018700  0.0000000  0.0000000  0.0010110  0.0000000  0.0000000 -0.0001751;
                     0.0722880 -0.0015885 -0.0205625 -0.1525625 -0.1848702  0.6108720  0.5074913 -0.0242294  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 16 # S
            _zn = 16
            _nα = 9
            _nβ = 7
            _ne = 16
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 4;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 16.017781;
                   18.751023;
                    2.821455;
                    9.912367;
                    8.287787;
                    5.552517;
                    1.950564;
                    1.464681;
                    8.063750;
                    8.063750;
                    8.063750;
                    3.971390;
                    3.971390;
                    3.971390;
                   13.749257;
                   13.749257;
                   13.749257;
                    8.508953;
                    8.508953;
                    8.508953;
                    6.140269;
                    6.140269;
                    6.140269;
                    2.682292;
                    2.682292;
                    2.682292;
                    1.776969;
                    1.776969;
                    1.776969;
                    1.225382;
                    1.225382;
                    1.225382;]
            _cαp = [ 0.9708794  0.0278229  0.0015724 -0.0548721  0.0737365 -0.0062293 -0.0012459  0.0004515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2681472 -0.0004836  0.0041448 -0.3612903  1.0808202  0.3385185 -0.0004014  0.0003694  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731;
                     0.0778146  0.0006181  0.4686100  0.1224849 -0.3449734 -0.1904166  0.4819059  0.1888569  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1534507  0.0000000  0.0000000  0.1775446  0.0000000  0.0000000 -0.0050407  0.0000000  0.0000000 -0.0491572  0.0000000  0.0000000 -0.0494257  0.0000000  0.0000000  0.4215595  0.0000000  0.0000000  0.4066538  0.0000000  0.0000000  0.1368914  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1534507  0.0000000  0.0000000  0.1775446  0.0000000  0.0000000 -0.0050407  0.0000000  0.0000000 -0.0491572  0.0000000  0.0000000 -0.0494257  0.0000000  0.0000000  0.4215595  0.0000000  0.0000000  0.4066538  0.0000000  0.0000000  0.1368914  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1534507  0.0000000  0.0000000  0.1775446  0.0000000  0.0000000 -0.0050407  0.0000000  0.0000000 -0.0491572  0.0000000  0.0000000 -0.0494257  0.0000000  0.0000000  0.4215595  0.0000000  0.0000000  0.4066538  0.0000000  0.0000000  0.1368914;]
            _cβp = [ 0.9708794  0.0278229  0.0015724 -0.0548721  0.0737365 -0.0062293 -0.0012459  0.0004515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2681472 -0.0004836  0.0041448 -0.3612903  1.0808202  0.3385185 -0.0004014  0.0003694  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6027342  0.0000000  0.0000000  0.0236363  0.0000000  0.0000000  0.0194144  0.0000000  0.0000000  0.2286123  0.0000000  0.0000000  0.2460604  0.0000000  0.0000000 -0.0015081  0.0000000  0.0000000  0.0012232  0.0000000  0.0000000 -0.0000731;
                     0.0778146  0.0006181  0.4686100  0.1224849 -0.3449734 -0.1904166  0.4819059  0.1888569  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1534507  0.0000000  0.0000000  0.1775446  0.0000000  0.0000000 -0.0050407  0.0000000  0.0000000 -0.0491572  0.0000000  0.0000000 -0.0494257  0.0000000  0.0000000  0.4215595  0.0000000  0.0000000  0.4066538  0.0000000  0.0000000  0.1368914  0.0000000  0.0000000;]
        elseif atom == 17 # Cl
            _zn = 17
            _nα = 9
            _nβ = 8
            _ne = 17
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 17.013356;
                   19.254490;
                   12.312072;
                    8.229951;
                    5.988503;
                    3.240229;
                    2.241557;
                    1.628622;
                    8.564875;
                    8.564875;
                    8.564875;
                    4.394862;
                    4.394862;
                    4.394862;
                   14.766056;
                   14.766056;
                   14.766056;
                    9.108579;
                    9.108579;
                    9.108579;
                    6.654792;
                    6.654792;
                    6.654792;
                    2.956777;
                    2.956777;
                    2.956777;
                    1.950041;
                    1.950041;
                    1.950041;
                    1.335606;
                    1.335606;
                    1.335606;]
            _cαp = [ 0.9725588  0.0299176  0.0154957 -0.0056631  0.0032471 -0.0012533  0.0008618 -0.0002917  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2725611 -0.0021393  0.2195591  0.5541870  0.3071947  0.0053977 -0.0001811  0.0003926  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834;
                     0.0824414  0.0011688 -0.0760871 -0.1679399 -0.2094142  0.4193004  0.5300040  0.2085515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1673509  0.0000000  0.0000000  0.1962385  0.0000000  0.0000000 -0.0048057  0.0000000  0.0000000 -0.0488472  0.0000000  0.0000000 -0.0516853  0.0000000  0.0000000  0.4323071  0.0000000  0.0000000  0.3934392  0.0000000  0.0000000  0.1283892  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1673509  0.0000000  0.0000000  0.1962385  0.0000000  0.0000000 -0.0048057  0.0000000  0.0000000 -0.0488472  0.0000000  0.0000000 -0.0516853  0.0000000  0.0000000  0.4323071  0.0000000  0.0000000  0.3934392  0.0000000  0.0000000  0.1283892  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1673509  0.0000000  0.0000000  0.1962385  0.0000000  0.0000000 -0.0048057  0.0000000  0.0000000 -0.0488472  0.0000000  0.0000000 -0.0516853  0.0000000  0.0000000  0.4323071  0.0000000  0.0000000  0.3934392  0.0000000  0.0000000  0.1283892;]
            _cβp = [ 0.9725588  0.0299176  0.0154957 -0.0056631  0.0032471 -0.0012533  0.0008618 -0.0002917  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2725611 -0.0021393  0.2195591  0.5541870  0.3071947  0.0053977 -0.0001811  0.0003926  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6216521  0.0000000  0.0000000  0.0217791  0.0000000  0.0000000  0.0175478  0.0000000  0.0000000  0.2197411  0.0000000  0.0000000  0.2320683  0.0000000  0.0000000 -0.0003956  0.0000000  0.0000000  0.0012233  0.0000000  0.0000000  0.0000834;
                     0.0824414  0.0011688 -0.0760871 -0.1679399 -0.2094142  0.4193004  0.5300040  0.2085515  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1673509  0.0000000  0.0000000  0.1962385  0.0000000  0.0000000 -0.0048057  0.0000000  0.0000000 -0.0488472  0.0000000  0.0000000 -0.0516853  0.0000000  0.0000000  0.4323071  0.0000000  0.0000000  0.3934392  0.0000000  0.0000000  0.1283892  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1673509  0.0000000  0.0000000  0.1962385  0.0000000  0.0000000 -0.0048057  0.0000000  0.0000000 -0.0488472  0.0000000  0.0000000 -0.0516853  0.0000000  0.0000000  0.4323071  0.0000000  0.0000000  0.3934392  0.0000000  0.0000000  0.1283892  0.0000000;]
        elseif atom == 18 # Ar
            _zn = 18
            _nα = 9
            _nβ = 9
            _ne = 18
            _np = 32
            _ep = [ 0 0 0 1;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;
                    1 0 0 4;
                    0 1 0 4;
                    0 0 1 4;]
            _ζ = [ 18.013746;
                   20.412705;
                   13.172305;
                    8.843595;
                    3.599100;
                    6.465717;
                    2.483448;
                    1.785204;
                    9.068490;
                    9.068490;
                    9.068490;
                   15.906705;
                   15.906705;
                   15.906705;
                    9.759930;
                    9.759930;
                    9.759930;
                    7.205294;
                    7.205294;
                    7.205294;
                    4.846785;
                    4.846785;
                    4.846785;
                    3.255603;
                    3.255603;
                    3.255603;
                    2.141219;
                    2.141219;
                    2.141219;
                    1.458981;
                    1.458981;
                    1.458981;]
            _cαp = [ 0.9737150  0.0282162  0.0155047 -0.0057517 -0.0012824  0.0033199  0.0008104 -0.0002636  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2764028 -0.0020975  0.2121243  0.5598507  0.0065501  0.3071697 -0.0000724  0.0004532  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883;
                     0.0863631  0.0011741 -0.0760208 -0.1745834  0.4075599 -0.2257335  0.5487733  0.2134787  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043;]
            _cβp = [ 0.9737150  0.0282162  0.0155047 -0.0057517 -0.0012824  0.0033199  0.0008104 -0.0002636  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2764028 -0.0020975  0.2121243  0.5598507  0.0065501  0.3071697 -0.0000724  0.0004532  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.6385867  0.0000000  0.0000000  0.0153640  0.0000000  0.0000000  0.2070551  0.0000000  0.0000000  0.2242823  0.0000000  0.0000000  0.0213321  0.0000000  0.0000000 -0.0006792  0.0000000  0.0000000  0.0004750  0.0000000  0.0000000 -0.0000883;
                     0.0863631  0.0011741 -0.0760208 -0.1745834  0.4075599 -0.2257335  0.5487733  0.2134787  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.1782532  0.0000000  0.0000000 -0.0043791  0.0000000  0.0000000 -0.0466335  0.0000000  0.0000000 -0.0546346  0.0000000  0.0000000  0.2045286  0.0000000  0.0000000  0.4397275  0.0000000  0.0000000  0.3881559  0.0000000  0.0000000  0.1232043;]
        end
    elseif base == "dz"
        if atom == 2 # He
            _zn = 2
            _nα = 1
            _nβ = 1
            _ne = 2
            _np = 2
            _ep = [ 0 0 0 1;
                    0 0 0 1;]
            _ζ = [  2.906248;
                    1.452965;]
            _cαp = [ 0.1815838  0.8429107;]
            _cβp = [ 0.1815838  0.8429107;]
        elseif atom == 3 # Li
            _zn = 3
            _nα = 2
            _nβ = 1
            _ne = 3
            _np = 4
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;]
            _ζ = [  2.460961;
                    4.644077;
                    0.563539;
                    0.913559;]
            _cαp = [ 0.8935165  0.1178233 -0.0005871  0.0050386;
                    -0.1016703 -0.0173271  1.9244342 -1.1143516;]
            _cβp = [ 0.8935165  0.1178233 -0.0005871  0.0050386;]
        elseif atom == 4 # Be
            _zn = 4
            _nα = 2
            _nβ = 2
            _ne = 4
            _np = 4
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;]
            _ζ = [  6.375345;
                    3.466430;
                    1.778321;
                    0.726092;]
            _cαp = [ 0.0873931  0.9162322  0.0082465 -0.0005309;
                    -0.0139400 -0.1016005 -0.5438827  1.3449665;]
            _cβp = [ 0.0873931  0.9162322  0.0082465 -0.0005309;
                    -0.0139400 -0.1016005 -0.5438827  1.3449665;]
        elseif atom == 5 # B
            _zn = 5
            _nα = 3
            _nβ = 2
            _ne = 5
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  4.605080;
                    0.958779;
                    2.562751;
                    6.651908;
                    2.207904;
                    2.207904;
                    2.207904;
                    1.002833;
                    1.002833;
                    1.002833;]
            _cαp = [ 1.0443256 -0.0004166  0.0248867 -0.0680070  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1194325  1.3034487 -0.5239490  0.0128331  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.2175650  0.0000000  0.0000000  0.8384839  0.0000000  0.0000000;]
            _cβp = [ 1.0443256 -0.0004166  0.0248867 -0.0680070  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1194325  1.3034487 -0.5239490  0.0128331  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 6 # C
            _zn = 6
            _nα = 4
            _nβ = 2
            _ne = 6
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  5.623336;
                    3.358320;
                    1.180284;
                    8.068164;
                    2.721610;
                    2.721610;
                    2.721610;
                    1.253859;
                    1.253859;
                    1.253859;]
            _cαp = [ 1.0217447  0.0353980  0.0002067 -0.0555642  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1046262 -0.5192316  1.2780751  0.0113100  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.2616791  0.0000000  0.0000000  0.8006451  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2616791  0.0000000  0.0000000  0.8006451  0.0000000;]
            _cβp = [ 1.0217447  0.0353980  0.0002067 -0.0555642  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1046262 -0.5192316  1.2780751  0.0113100  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 7 # N
            _zn = 7
            _nα = 5
            _nβ = 2
            _ne = 7
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  6.647656;
                    4.159313;
                    1.397854;
                    9.476457;
                    3.238097;
                    3.238097;
                    3.238097;
                    1.495529;
                    1.495529;
                    1.495529;]
            _cαp = [ 1.0018390  0.0469079  0.0006651 -0.0468355  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0897813 -0.5212570  1.2618581  0.0101875  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.2908586  0.0000000  0.0000000  0.7757754  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2908586  0.0000000  0.0000000  0.7757754  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2908586  0.0000000  0.0000000  0.7757754;]
            _cβp = [ 1.0018390  0.0469079  0.0006651 -0.0468355  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0897813 -0.5212570  1.2618581  0.0101875  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 8 # O
            _zn = 8
            _nα = 5
            _nβ = 3
            _ne = 8
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 10.405088;
                    1.621858;
                    5.182730;
                    8.741873;
                    3.685754;
                    3.685754;
                    3.685754;
                    1.655343;
                    1.655343;
                    1.655343;]
            _cαp = [ 0.6102049  0.0008252  0.0931928  0.3513728  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0126673  1.2487315 -0.5973569  0.0189004  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3342659  0.0000000  0.0000000  0.7429903  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3342659  0.0000000  0.0000000  0.7429903  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3342659  0.0000000  0.0000000  0.7429903;]
            _cβp = [ 0.6102049  0.0008252  0.0931928  0.3513728  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0126673  1.2487315 -0.5973569  0.0189004  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3342659  0.0000000  0.0000000  0.7429903  0.0000000  0.0000000;]
        elseif atom == 9 # F
            _zn = 9
            _nα = 5
            _nβ = 4
            _ne = 9
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  8.775637;
                    1.841977;
                   12.761664;
                    7.007894;
                    4.175044;
                    4.175044;
                    4.175044;
                    1.847075;
                    1.847075;
                    1.847075;]
            _cαp = [ 0.9946643  0.0016049 -0.0284728  0.0424275  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3492194  1.2387528  0.0021357 -0.2763038  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3565253  0.0000000  0.0000000  0.7262137  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3565253  0.0000000  0.0000000  0.7262137  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3565253  0.0000000  0.0000000  0.7262137;]
            _cβp = [ 0.9946643  0.0016049 -0.0284728  0.0424275  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3492194  1.2387528  0.0021357 -0.2763038  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3565253  0.0000000  0.0000000  0.7262137  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3565253  0.0000000  0.0000000  0.7262137  0.0000000;]
        elseif atom == 10 # Ne
            _zn = 10
            _nα = 5
            _nβ = 5
            _ne = 10
            _np = 10
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  9.830976;
                    2.063122;
                    7.921462;
                   14.362846;
                    4.678869;
                    4.678869;
                    4.678869;
                    2.053118;
                    2.053118;
                    2.053118;]
            _cαp = [ 0.9856762  0.0018049  0.0476768 -0.0237311  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3501320  1.2352408 -0.2734106  0.0018332  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688;]
            _cβp = [ 0.9856762  0.0018049  0.0476768 -0.0237311  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3501320  1.2352408 -0.2734106  0.0018332  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3699835  0.0000000  0.0000000  0.7158688;]
        elseif atom == 11 # Na
            _zn = 11
            _nα = 6
            _nβ = 5
            _ne = 11
            _np = 12
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 11.168640;
                    6.781373;
                    2.431663;
                    1.678432;
                    0.629976;
                   12.778573;
                    5.462475;
                    5.462475;
                    5.462475;
                    2.557004;
                    2.557004;
                    2.557004;]
            _cαp = [ 0.9082367  0.0706489  0.0004051  0.0002457 -0.0000587  0.0359066  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0908049 -0.5759832  1.3127062 -0.0071190  0.0009163 -0.0075654  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403;
                     0.0122179  0.0910246 -0.2073186 -0.1124346  1.0716114  0.0014388  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9082367  0.0706489  0.0004051  0.0002457 -0.0000587  0.0359066  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0908049 -0.5759832  1.3127062 -0.0071190  0.0009163 -0.0075654  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3377885  0.0000000  0.0000000  0.7331403;]
        elseif atom == 12 # Mg
            _zn = 12
            _nα = 6
            _nβ = 6
            _ne = 12
            _np = 12
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 18.806120;
                   11.518552;
                    7.252931;
                    2.794477;
                    1.406568;
                    0.640199;
                    6.206107;
                    6.206107;
                    6.206107;
                    3.041202;
                    3.041202;
                    3.041202;]
            _cαp = [ 0.0405525  0.9186519  0.0473771  0.0008113  0.0001509 -0.0000504  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0043687 -0.0923553 -0.6450855  1.3850886 -0.0255485  0.0035285  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854;
                     0.0006706  0.0160589  0.1291995 -0.1401753 -0.8381209  1.5415188  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.0405525  0.9186519  0.0473771  0.0008113  0.0001509 -0.0000504  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0043687 -0.0923553 -0.6450855  1.3850886 -0.0255485  0.0035285  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.3165229  0.0000000  0.0000000  0.7446854;
                     0.0006706  0.0160589  0.1291995 -0.1401753 -0.8381209  1.5415188  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 13 # Al
            _zn = 13
            _nα = 7
            _nβ = 6
            _ne = 13
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 16.224652;
                    7.581738;
                    3.170480;
                    1.907407;
                    0.817738;
                   14.034420;
                    9.151379;
                    9.151379;
                    9.151379;
                    4.906439;
                    4.906439;
                    4.906439;
                    0.758880;
                    0.758880;
                    0.758880;
                    3.600611;
                    3.600611;
                    3.600611;]
            _cαp = [ 0.6766526  0.0548156 -0.0014978  0.0010869 -0.0001802  0.3190087  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0833442 -0.6958664  1.4727572 -0.0469640  0.0038329 -0.0456673  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763;
                     0.0190175  0.1585895 -0.0542525 -1.0215893  1.5696283  0.0116380  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0162855  0.0000000  0.0000000 -0.1301602  0.0000000  0.0000000  1.0359716  0.0000000  0.0000000 -0.1117404  0.0000000  0.0000000;]
            _cβp = [ 0.6766526  0.0548156 -0.0014978  0.0010869 -0.0001802  0.3190087  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0833442 -0.6958664  1.4727572 -0.0469640  0.0038329 -0.0456673  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0818046  0.0000000  0.0000000  0.6911232  0.0000000  0.0000000  0.0028934  0.0000000  0.0000000  0.3110763;
                     0.0190175  0.1585895 -0.0542525 -1.0215893  1.5696283  0.0116380  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 14 # Si
            _zn = 14
            _nα = 8
            _nβ = 6
            _ne = 14
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 17.355199;
                    8.019594;
                    3.538907;
                    2.377375;
                    0.972549;
                   15.074620;
                   10.078952;
                   10.078952;
                   10.078952;
                    5.479941;
                    5.479941;
                    5.479941;
                    0.958703;
                    0.958703;
                    0.958703;
                    4.116800;
                    4.116800;
                    4.116800;]
            _cαp = [ 0.6866124  0.0508198 -0.0027683  0.0017057 -0.0001965  0.3125284  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0907400 -0.7516560  1.5643822 -0.0800027  0.0043552 -0.0506655  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286;
                     0.0233221  0.1843480  0.0802053 -1.2199148  1.5851366  0.0145868  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0172526  0.0000000  0.0000000 -0.1591355  0.0000000  0.0000000  1.0508193  0.0000000  0.0000000 -0.1329011  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0172526  0.0000000  0.0000000 -0.1591355  0.0000000  0.0000000  1.0508193  0.0000000  0.0000000 -0.1329011  0.0000000;]
            _cβp = [ 0.6866124  0.0508198 -0.0027683  0.0017057 -0.0001965  0.3125284  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0907400 -0.7516560  1.5643822 -0.0800027  0.0043552 -0.0506655  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0749537  0.0000000  0.0000000  0.6941590  0.0000000  0.0000000  0.0031357  0.0000000  0.0000000  0.3079286;
                     0.0233221  0.1843480  0.0802053 -1.2199148  1.5851366  0.0145868  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 15 # P
            _zn = 15
            _nα = 9
            _nβ = 6
            _ne = 15
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 2;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 18.587804;
                    2.895767;
                    1.116863;
                   16.199143;
                   10.749220;
                    3.250417;
                   11.126673;
                   11.126673;
                   11.126673;
                    6.106205;
                    6.106205;
                    6.106205;
                    1.145751;
                    1.145751;
                    1.145751;
                    4.658283;
                    4.658283;
                    4.658283;]
            _cαp = [ 0.7039440  0.0001646 -0.0000708  0.3203916  0.0287373  0.0001753  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3290245  2.2440305  0.0013565 -0.2154545 -0.3988047 -0.9109670  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289;
                     0.0885957 -0.9687797  1.5900991  0.0587666  0.1097701 -0.2317935  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0162871  0.0000000  0.0000000 -0.1792098  0.0000000  0.0000000  1.0622286  0.0000000  0.0000000 -0.1497182  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0162871  0.0000000  0.0000000 -0.1792098  0.0000000  0.0000000  1.0622286  0.0000000  0.0000000 -0.1497182  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0162871  0.0000000  0.0000000 -0.1792098  0.0000000  0.0000000  1.0622286  0.0000000  0.0000000 -0.1497182;]
            _cβp = [ 0.7039440  0.0001646 -0.0000708  0.3203916  0.0287373  0.0001753  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3290245  2.2440305  0.0013565 -0.2154545 -0.3988047 -0.9109670  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0649825  0.0000000  0.0000000  0.6918027  0.0000000  0.0000000  0.0032668  0.0000000  0.0000000  0.3156289;
                     0.0885957 -0.9687797  1.5900991  0.0587666  0.1097701 -0.2317935  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 16 # S
            _zn = 16
            _nα = 9
            _nβ = 7
            _ne = 16
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 1;
                    0 0 0 1;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 19.652050;
                   17.192158;
                    9.087968;
                    3.719495;
                    3.355192;
                    1.261576;
                    9.509619;
                    9.509619;
                    9.509619;
                    5.120401;
                    5.120401;
                    5.120401;
                    2.335459;
                    2.335459;
                    2.335459;
                    1.331864;
                    1.331864;
                    1.331864;]
            _cαp = [ 0.6994704  0.3010484  0.0484004  0.0027507 -0.0045089 -0.0001978  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0949969 -0.0522851 -0.8395337 -0.8386078  2.2935160  0.0022271  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217;
                     0.0268385  0.0161136  0.2301542 -0.3016557 -0.9650962  1.6019891  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0524799  0.0000000  0.0000000 -0.2199657  0.0000000  0.0000000  0.5394090  0.0000000  0.0000000  0.5597815  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0524799  0.0000000  0.0000000 -0.2199657  0.0000000  0.0000000  0.5394090  0.0000000  0.0000000  0.5597815  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0524799  0.0000000  0.0000000 -0.2199657  0.0000000  0.0000000  0.5394090  0.0000000  0.0000000  0.5597815;]
            _cβp = [ 0.6994704  0.3010484  0.0484004  0.0027507 -0.0045089 -0.0001978  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.0949969 -0.0522851 -0.8395337 -0.8386078  2.2935160  0.0022271  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2162729  0.0000000  0.0000000  0.8135403  0.0000000  0.0000000  0.0209114  0.0000000  0.0000000 -0.0057217;
                     0.0268385  0.0161136  0.2301542 -0.3016557 -0.9650962  1.6019891  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0524799  0.0000000  0.0000000 -0.2199657  0.0000000  0.0000000  0.5394090  0.0000000  0.0000000  0.5597815  0.0000000  0.0000000;]
        elseif atom == 17 # Cl
            _zn = 17
            _nα = 9
            _nβ = 8
            _ne = 17
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 1;
                    0 0 0 2;
                    0 0 0 1;
                    0 0 0 1;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 20.752280;
                   18.214576;
                    9.498674;
                    4.169749;
                    3.814789;
                    1.401342;
                   10.269168;
                   10.269168;
                   10.269168;
                    5.608268;
                    5.608268;
                    5.608268;
                    2.611294;
                    2.611294;
                    2.611294;
                    1.464645;
                    1.464645;
                    1.464645;]
            _cαp = [ 0.7082739  0.2948587  0.0454423  0.0030504 -0.0055031 -0.0002032  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1003154 -0.0553040 -0.9094640 -0.7396812  2.2795349  0.0035240  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859;
                     0.0301693  0.0183422  0.2484400 -0.3736721 -0.9421051  1.6115603  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0519112  0.0000000  0.0000000 -0.2369164  0.0000000  0.0000000  0.5645707  0.0000000  0.0000000  0.5430303  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0519112  0.0000000  0.0000000 -0.2369164  0.0000000  0.0000000  0.5645707  0.0000000  0.0000000  0.5430303  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0519112  0.0000000  0.0000000 -0.2369164  0.0000000  0.0000000  0.5645707  0.0000000  0.0000000  0.5430303;]
            _cβp = [ 0.7082739  0.2948587  0.0454423  0.0030504 -0.0055031 -0.0002032  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1003154 -0.0553040 -0.9094640 -0.7396812  2.2795349  0.0035240  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.2055216  0.0000000  0.0000000  0.8212857  0.0000000  0.0000000  0.0202222  0.0000000  0.0000000 -0.0045859;
                     0.0301693  0.0183422  0.2484400 -0.3736721 -0.9421051  1.6115603  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0519112  0.0000000  0.0000000 -0.2369164  0.0000000  0.0000000  0.5645707  0.0000000  0.0000000  0.5430303  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0519112  0.0000000  0.0000000 -0.2369164  0.0000000  0.0000000  0.5645707  0.0000000  0.0000000  0.5430303  0.0000000;]
        elseif atom == 18 # Ar
            _zn = 18
            _nα = 9
            _nβ = 9
            _ne = 18
            _np = 18
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;
                    1 0 0 3;
                    0 1 0 3;
                    0 0 1 3;]
            _ζ = [ 21.845690;
                    9.898937;
                    5.117419;
                    4.239995;
                    1.538085;
                   19.233411;
                   11.027758;
                   11.027758;
                   11.027758;
                    6.095686;
                    6.095686;
                    6.095686;
                    2.886169;
                    2.886169;
                    2.886169;
                    1.608544;
                    1.608544;
                    1.608544;]
            _cαp = [ 0.7164979  0.0431048 -0.0094171  0.0057188 -0.0002138  0.2887674  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1041073 -0.9983527  1.9371984 -0.2102998  0.0055156 -0.0569129  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039;
                     0.0337778  0.2592165  1.1598113 -2.4564115  1.6210762  0.0208833  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656;]
            _cβp = [ 0.7164979  0.0431048 -0.0094171  0.0057188 -0.0002138  0.2887674  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.1041073 -0.9983527  1.9371984 -0.2102998  0.0055156 -0.0569129  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.1959966  0.0000000  0.0000000  0.8288483  0.0000000  0.0000000  0.0186914  0.0000000  0.0000000 -0.0050039;
                     0.0337778  0.2592165  1.1598113 -2.4564115  1.6210762  0.0208833  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.0504469  0.0000000  0.0000000 -0.2500795  0.0000000  0.0000000  0.5809860  0.0000000  0.0000000  0.5321656;]
        end
    elseif base == "sz"
        if atom == 2 # He
            _zn = 2
            _nα = 1
            _nβ = 1
            _ne = 2
            _np = 1
            _ep = [ 0 0 0 1;]
            _ζ = [  1.687500;]
            _cαp = [ 1.0000000;]'
            _cβp = [ 1.0000000;]'
        elseif atom == 3 # Li
            _zn = 3
            _nα = 2
            _nβ = 1
            _ne = 3
            _np = 2
            _ep = [ 0 0 0 1;
                    0 0 0 2;]
            _ζ = [  2.690635;
                    0.639609;]
            _cαp = [ 0.9971664  0.0165948;
                    -0.1812203  1.0133638;]
            _cβp = [ 0.9971664  0.0165948;]
        elseif atom == 4 # Be
            _zn = 4
            _nα = 2
            _nβ = 2
            _ne = 4
            _np = 2
            _ep = [ 0 0 0 1;
                    0 0 0 2;]
            _ζ = [  3.684801;
                    0.956031;]
            _cαp = [ 0.9975867  0.0123882;
                    -0.2044390  1.0182442;]
            _cβp = [ 0.9975867  0.0123882;
                    -0.2044390  1.0182442;]
        elseif atom == 5 # B
            _zn = 5
            _nα = 3
            _nβ = 2
            _ne = 5
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  4.679423;
                    1.288082;
                    1.210660;
                    1.210660;
                    1.210660;]
            _cαp = [ 0.9974872  0.0117480  0.0000000  0.0000000  0.0000000;
                    -0.2244156  1.0223528  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9974872  0.0117480  0.0000000  0.0000000  0.0000000;
                    -0.2244156  1.0223528  0.0000000  0.0000000  0.0000000;]
        elseif atom == 6 # C
            _zn = 6
            _nα = 4
            _nβ = 2
            _ne = 6
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  5.672661;
                    1.608328;
                    1.567893;
                    1.567893;
                    1.567893;]
            _cαp = [ 0.9974388  0.0114353  0.0000000  0.0000000  0.0000000;
                    -0.2350848  1.0247040  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;]
            _cβp = [ 0.9974388  0.0114353  0.0000000  0.0000000  0.0000000;
                    -0.2350848  1.0247040  0.0000000  0.0000000  0.0000000;]
        elseif atom == 7 # N
            _zn = 7
            _nα = 5
            _nβ = 2
            _ne = 7
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  6.665116;
                    1.923687;
                    1.917035;
                    1.917035;
                    1.917035;]
            _cαp = [ 0.9974013  0.0112865  0.0000000  0.0000000  0.0000000;
                    -0.2417843  1.0262269  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
            _cβp = [ 0.9974013  0.0112865  0.0000000  0.0000000  0.0000000;
                    -0.2417843  1.0262269  0.0000000  0.0000000  0.0000000;]
        elseif atom == 8 # O
            _zn = 8
            _nα = 5
            _nβ = 3
            _ne = 8
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  7.657862;
                    2.245883;
                    2.226629;
                    2.226629;
                    2.226629;]
            _cαp = [ 0.9973856  0.0110798  0.0000000  0.0000000  0.0000000;
                    -0.2478826  1.0276677  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
            _cβp = [ 0.9973856  0.0110798  0.0000000  0.0000000  0.0000000;
                    -0.2478826  1.0276677  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;]
        elseif atom == 9 # F
            _zn = 9
            _nα = 5
            _nβ = 4
            _ne = 9
            _np = 5
            _ep = [    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  8.650127;
                    2.563883;
                    2.549979;
                    2.549979;
                    2.549979;]
            _cαp = [ 0.9973690  0.0109711  0.0000000  0.0000000  0.0000000;
                    -0.2520204  1.0286587  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
            _cβp = [ 0.9973690  0.0109711  0.0000000  0.0000000  0.0000000;
                    -0.2520204  1.0286587  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;]
        elseif atom == 10 # Ne
            _zn = 10
            _nα = 5
            _nβ = 5
            _ne = 10
            _np = 5
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [  9.642066;
                    2.879243;
                    2.879239;
                    2.879239;
                    2.879239;]
            _cαp = [ 0.9973518  0.0109176  0.0000000  0.0000000  0.0000000;
                    -0.2549913  1.0293745  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
            _cβp = [ 0.9973518  0.0109176  0.0000000  0.0000000  0.0000000;
                    -0.2549913  1.0293745  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
        elseif atom == 11 # Na
            _zn = 11
            _nα = 6
            _nβ = 5
            _ne = 11
            _np = 6
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 10.625901;
                    3.285746;
                    0.835713;
                    3.400902;
                    3.400902;
                    3.400902;]
            _cαp = [ 0.9972116  0.0109080 -0.0009775  0.0000000  0.0000000  0.0000000;
                    -0.2690620  1.0313065  0.0118864  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;
                     0.0356908 -0.1455741  1.0082371  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9972116  0.0109080 -0.0009775  0.0000000  0.0000000  0.0000000;
                    -0.2690620  1.0313065  0.0118864  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;]
        elseif atom == 12 # Mg
            _zn = 12
            _nα = 6
            _nβ = 6
            _ne = 12
            _np = 6
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 11.608926;
                    3.696024;
                    1.102505;
                    3.912881;
                    3.912881;
                    3.912881;]
            _cαp = [ 0.9971591  0.0106510 -0.0012943  0.0000000  0.0000000  0.0000000;
                    -0.2815134  1.0347867  0.0075437  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;
                     0.0503232 -0.1998560  1.0170290  0.0000000  0.0000000  0.0000000;]
            _cβp = [ 0.9971591  0.0106510 -0.0012943  0.0000000  0.0000000  0.0000000;
                    -0.2815134  1.0347867  0.0075437  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  1.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  1.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  1.0000000;
                     0.0503232 -0.1998560  1.0170290  0.0000000  0.0000000  0.0000000;]
        elseif atom == 13 # Al
            _zn = 13
            _nα = 7
            _nβ = 6
            _ne = 13
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 12.591096;
                    4.106013;
                    1.376915;
                    4.484067;
                    4.484067;
                    4.484067;
                    0.912369;
                    0.912369;
                    0.912369;]
            _cαp = [ 0.9971522  0.0103227 -0.0015275  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2920444  1.0380253  0.0046686  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190;
                     0.0650132 -0.2529937  1.0281485  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3232168  0.0000000  0.0000000  1.0259223  0.0000000  0.0000000;]
            _cβp = [ 0.9971522  0.0103227 -0.0015275  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.2920444  1.0380253  0.0046686  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9771846  0.0000000  0.0000000  0.0827190;
                     0.0650132 -0.2529937  1.0281485  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 14 # Si
            _zn = 14
            _nα = 8
            _nβ = 6
            _ne = 14
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 13.574623;
                    4.508793;
                    1.641689;
                    4.971882;
                    4.971882;
                    4.971882;
                    0.971388;
                    0.971388;
                    0.971388;]
            _cαp = [ 0.9971968  0.0099111 -0.0016758  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3004688  1.0416914 -0.0005150  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931;
                     0.0768556 -0.2951229  1.0395293  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.2888920  0.0000000  0.0000000  1.0233983  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.2888920  0.0000000  0.0000000  1.0233983  0.0000000;]
            _cβp = [ 0.9971968  0.0099111 -0.0016758  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3004688  1.0416914 -0.0005150  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9838666  0.0000000  0.0000000  0.0640931;
                     0.0768556 -0.2951229  1.0395293  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 15 # P
            _zn = 15
            _nα = 9
            _nβ = 6
            _ne = 15
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 2;
                    0 0 0 3;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 14.557898;
                    4.910540;
                    1.889530;
                    4.473270;
                    4.473270;
                    4.473270;
                    1.117560;
                    1.117560;
                    1.117560;]
            _cαp = [ 0.9972717  0.0094507 -0.0017322  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3077145  1.0451821 -0.0048947  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689;
                     0.0861271 -0.3269654  1.0493597  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3017244  0.0000000  0.0000000  1.0279358  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3017244  0.0000000  0.0000000  1.0279358  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3017244  0.0000000  0.0000000  1.0279358;]
            _cβp = [ 0.9972717  0.0094507 -0.0017322  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3077145  1.0451821 -0.0048947  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9844067  0.0000000  0.0000000  0.0586689;
                     0.0861271 -0.3269654  1.0493597  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;]
        elseif atom == 16 # S
            _zn = 16
            _nα = 9
            _nβ = 7
            _ne = 16
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 15.556784;
                    1.073290;
                    5.239890;
                    5.972680;
                    5.972680;
                    5.972680;
                    1.259700;
                    1.259700;
                    1.259700;]
            _cαp = [ 0.9972994 -0.0026692  0.0104313  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3080344 -0.0262489  1.0596752  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585;
                     0.0721162  1.2645868 -0.7710259  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3128068  0.0000000  0.0000000  1.0316024  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3128068  0.0000000  0.0000000  1.0316024  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3128068  0.0000000  0.0000000  1.0316024;]
            _cβp = [ 0.9972994 -0.0026692  0.0104313  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3080344 -0.0262489  1.0596752  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9846025  0.0000000  0.0000000  0.0555585;
                     0.0721162  1.2645868 -0.7710259  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3128068  0.0000000  0.0000000  1.0316024  0.0000000  0.0000000;]
        elseif atom == 17 # Cl
            _zn = 17
            _nα = 9
            _nβ = 8
            _ne = 17
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 16.543330;
                    1.220550;
                    5.633802;
                    6.471620;
                    6.471620;
                    6.471620;
                    1.411706;
                    1.411706;
                    1.411706;]
            _cαp = [ 0.9973846 -0.0027159  0.0101012  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3133135 -0.0320217  1.0656653  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654;
                     0.0735736  1.3015573 -0.8272795  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3260865  0.0000000  0.0000000  1.0357484  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3260865  0.0000000  0.0000000  1.0357484  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3260865  0.0000000  0.0000000  1.0357484;]
            _cβp = [ 0.9973846 -0.0027159  0.0101012  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3133135 -0.0320217  1.0656653  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9845253  0.0000000  0.0000000  0.0533654;
                     0.0735736  1.3015573 -0.8272795  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3260865  0.0000000  0.0000000  1.0357484  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3260865  0.0000000  0.0000000  1.0357484  0.0000000;]
        elseif atom == 18 # Ar
            _zn = 18
            _nα = 9
            _nβ = 9
            _ne = 18
            _np = 9
            _ep = [ 0 0 0 1;
                    0 0 0 1;
                    0 0 0 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;
                    1 0 0 2;
                    0 1 0 2;
                    0 0 1 2;]
            _ζ = [ 17.529948;
                    1.365477;
                    6.027628;
                    6.968540;
                    6.968540;
                    6.968540;
                    1.567539;
                    1.567539;
                    1.567539;]
            _cαp = [ 0.9974766 -0.0027281  0.0097492  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3179617 -0.0371055  1.0711504  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266;
                     0.0744903  1.3347942 -0.8759832  0.0208833  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486;]
            _cβp = [ 0.9974766 -0.0027281  0.0097492  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                    -0.3179617 -0.0371055  1.0711504  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.9854007  0.0000000  0.0000000  0.0485266;
                     0.0744903  1.3347942 -0.8759832  0.0208833  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486  0.0000000  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486  0.0000000;
                     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3362162  0.0000000  0.0000000  1.0400486;]
        end
    end
    if ion ≠ 0 # 1s¹2s²2p⁴
        _ne -= 1
        if spin == 'α'
            _nα -= 1
            _cαp = _cαp[1:end .≠ ion, :]
        else
            _nβ -= 1
            _cβp = _cβp[1:end .≠ ion, :]
        end
    end
    _cαp .*= sqrt.((2_ζ).^(2_ep[:,4].+1) ./ (4pi*factorial.(2_ep[:,4])) .*
              dfact.(2sumd(_ep[:,1:3],2).+1) ./ prodd(dfact.(2_ep[:,1:3].-1),2))'
    if size(_cβp,2) ≠ 0
        _cβp .*= sqrt.((2_ζ).^(2_ep[:,4].+1) ./ (4pi*factorial.(2_ep[:,4])) .*
                 dfact.(2sumd(_ep[:,1:3],2).+1) ./ prodd(dfact.(2_ep[:,1:3].-1),2))'
    end
    sto = STOstr(
            _base, # base
            _zn, # zn
            _nα, # nα
            _nβ, # nβ
            _ne, # ne
            _np, # np
            _ep, # ep
            _ζ, # ζ
            _cαp, # cαp
            _cβp  # cβp
        )
    if true
        corp = Corstr(
            [ 0.0;  0.0;  0.0;  0.0;  # ee
              0.0;  0.0;  0.0; # ne
              0.0;  0.0 ], # nee e nne
            [ 0; 0; 0; 0;
              0; 0; 0;
              0; 0 ]
        )
    elseif icor
        corp = Corstr(
            [ 0.5;  0.0;  0.0;  0.0;  # ee
              0.0;  0.0;  0.0; # ne
              0.0;  0.0 ], # nee e nne
            [ 0; 1; 1; 1;
              1; 1; 1;
              1; 1 ]
        )
    end
    if iask && icor
        return qmcp, sto, corp
    elseif iask
        return qmcp, sto
    elseif icor
        return sto, corp
    else
        return sto
    end
end

@fastmath @views function stof(iαβ::Int, rci::Array{Float64,2}, ri::Array{Float64,1}, sto::STOstr)
    np, ep, ζ = sto.np, copy(sto.ep), sto.ζ
    nw = size(ri,1)
    if iαβ == 1
        no, csp = sto.nα, sto.cαp
    else
        no, csp = sto.nβ, sto.cβp
    end
    n = copy(ep[:,4])
    ep[:,4] .-= ep[:,1] .+ ep[:,2] .+ ep[:,3] .+ 1
    ri⁻¹ = ri.^-1
    # dpw = exp.(-ζ * ri')
    # gpw = repeat( -ζ * ri⁻¹' ,1,1,3)
    dpw = Array{Float64}(undef, np, nw)
    gpw = Array{Float64}(undef, np, nw, 3)
    lpw = Array{Float64}(undef, np, nw)
    κζ = Array{Float64}(undef, nw)
    mep4 = maximum(ep[:,4])
    if mep4 ≠ 0
        if mep4 ≠ 1
            rie = Array{Float64}(undef, nw, mep4-1)
            for i = 2:mep4
                rie[:,i-1] .= ri .^ i
            end
        end
    end
    mep123 = maximum(ep[:,1:3])
    if mep123 ≠ 0
        rci⁻¹ = rci.^-1
        if mep123 ≠ 1
            rci⁻² = rci.^-2
            for i = 2:mep123
                rcie[:,:,i-1] .= rci .^ i
            end
        end
    end
    @inbounds @simd for p = 1:np
        dpw[p,:] .= exp.(-ζ[p] .* ri)
        gpw[p,:,:] .= -ζ[p] .* ri⁻¹ .* rci
        lpw[p,:] .= ζ[p].^2 .- 2ζ[p] .* (ep[p,4] .+ 1) .* ri⁻¹
        if ep[p,4] ≠ 0
            if ep[p,4] == 1
                dpw[p,:] .*= ri
            else
                dpw[p,:] .*= rie[:,ep[p,4]-1]
            end
            gpw[p,:,:] .+= ep[p,4] .* rci .* ri⁻¹.^2
            lpw[p,:] .+= (ep[p,4] .+ 1) .* ep[p,4] .* ri⁻¹.^2
            if mep123 ≠ 0
                κζ .= (ep[p,4] .* ri⁻¹ .- ζ[p]) .* ri⁻¹
            end
        else
            κζ .= -ζ[p] .* ri⁻¹
        end
        @simd for i = 1:3
            if ep[p,i] ≠ 0
                gpw[p,:,i] .+= ep[p,i] .* rci⁻¹[:,i]
                lpw[p,:] .+= 2ep[p,i] .* κζ
                if ep[p,i] == 1
                    dpw[p,:] .*= rci[:,i]
                else
                    dpw[p,:] .*= rcie[:,i,ep[p,i]-1]
                    lpw[p,:] .+= ep[p,i] .* (ep[p,i] - 1) .* rci⁻²[:,i]
                end
            end
        end
    end
    gpw .*= dpw
    lpw .*= dpw
    # ψi = csp * dpw
    ψi = dpw' * csp'
    ∇ψi = Array{Float64}(undef, (size(ri,1),no,3))
    ∇ψi[:,:,1] .= gpw[:,:,1]' * csp'
    ∇ψi[:,:,2] .= gpw[:,:,2]' * csp'
    ∇ψi[:,:,3] .= gpw[:,:,3]' * csp'
    ∇²ψi = lpw' * csp'
    return ψi, ∇ψi, ∇²ψi
end

### Matrix of ψ are transposed, Slater determinant has rows for electrons and
### columns for orbitals.
function wavef(rc::Array{Float64,3}, sto::STOstr, c9r::Array{Float64,1})
    nw = size(rc,1)
    nα, nβ, ne = sto.nα, sto.nβ, sto.ne
    ψ = ones(nw)
    ψs = [zeros(nw,nα,nα), zeros(nw,nβ,nβ)]
    ∇ψs = [zeros(nw,nα,nα,3), zeros(nw,nβ,nβ,3)]
    ∇²ψs = [zeros(nw,nα,nα), zeros(nw,nβ,nβ)]
    ψ⁻¹s = [zeros(nw,nα,nα), zeros(nw,nβ,nβ)]
    r2 = rc[:,:,1].^2 .+ rc[:,:,2].^2 .+ rc[:,:,3].^2
    r = sqrt.(r2)
    rb = r./(1 .+ r)
    rb2 = rb.^2
    rb3 = rb.^3
    rb4 = rb.^4
    isp = 1
    iαβ = 0
    for i = 1:ne
        i ≠ nα + 1 || ((isp, iαβ) = (2, nα))
        for j = i+1:ne
            # if (i ≤ nα && j ≤ nα) || (i > nα && j > nα)
            #     ees = 0.5
            # else
                ees = 1.0
            # end
            rij = sqrt.((rc[:,i,1] - rc[:,j,1]).^2 .+ (rc[:,i,2] - rc[:,j,2]).^2 .+ (rc[:,i,3] - rc[:,j,3]).^2)
            rbij = rij ./ (1 .+ rij)
            rbij2 = rbij.^2
            rbij3 = rbij.^3
            rbij4 = rbij.^4
            corr = c9r[1] * ees * rbij
            corr += c9r[2] * rbij2
            corr += c9r[3] * rbij3
            corr += c9r[4] * rbij4
            corr += c9r[5] * (rb2[:,i] + rb2[:,j])
            corr += c9r[6] * (rb3[:,i] + rb3[:,j])
            corr += c9r[7] * (rb4[:,i] + rb4[:,j])
            corr += c9r[8] * (rb2[:,i] .* rb2[:,j])
            corr += c9r[9] * ((rb2[:,i] + rb2[:,j]) .* rbij2)
            ψ .*= exp.(corr)
        end
        ψs[isp][:,i-iαβ,:], ∇ψs[isp][:,i-iαβ,:,:], ∇²ψs[isp][:,i-iαβ,:] = stof(isp,rc[:,i,:],r[:,i],sto)
    end
    for w = 1:nw
        ψ[w] *= det(ψs[1][w,:,:]) * det(ψs[2][w,:,:])
        ψ⁻¹s[1][w,:,:] = inv(ψs[1][w,:,:])
        nβ ≠ 0 && (ψ⁻¹s[2][w,:,:] = inv(ψs[2][w,:,:]))
    end
    return Ψstr(ψ, ψs, ∇ψs, ∇²ψs, ψ⁻¹s)
end

### Matrix of ψ are transposed, Slater determinant has rows for electrons and
### columns for orbitals.
@fastmath function wavefup(i::Int, rci::Array{Float64,2}, ψ::Ψstr, rc::Array{Float64,3},
                 sto::STOstr, c9r::Array{Float64,1})
    @views begin
        nw = size(rc,1)
        nα, ne = sto.nα, sto.ne
        nei = 1:ne .≠ i
        ψn = copy(ψ.ψ)
        r2 = rc[:,:,1].^2 .+ rc[:,:,2].^2 .+ rc[:,:,3].^2
        r = sqrt.(r2)
        rb = r./(1 .+ r)
        rb2 = rb.^2
        rb3 = rb .* rb2
        rb4 = rb2.^2
        rn2 = rci[:,1].^2 .+ rci[:,2].^2 .+ rci[:,3].^2
        rn = sqrt.(rn2)
        rbn = rn./(1 .+ rn)
        rbn2 = rbn.^2
        rbn3 = rbn .* rbn2
        rbn4 = rbn2.^2
    end
    rij = sqrt.((rc[:,i,1] .- rc[:,nei,1]).^2 .+ (rc[:,i,2] .- rc[:,nei,2]).^2 .+ (rc[:,i,3] .- rc[:,nei,3]).^2)
    @views begin
        rbij = rij ./ (1 .+ rij)
        rbij2 = rbij.^2
        rbij3 = rbij .* rbij2
        rbij4 = rbij2.^2
    end
    rinj = sqrt.((rci[:,1] .- rc[:,nei,1]).^2 .+ (rci[:,2] .- rc[:,nei,2]).^2 .+ (rci[:,3] .- rc[:,nei,3]).^2)
    @views begin
        rbinj = rinj ./ (1 .+ rinj)
        rbinj2 = rbinj.^2
        rbinj3 = rbinj .* rbinj2
        rbinj4 = rbinj2.^2
        ees = 1.0
        corr = c9r[1] .* ees .* (rbinj .- rbij)
        corr .+= c9r[2] .* (rbinj2 .- rbij2)
        corr .+= c9r[3] .* (rbinj3 .- rbij3)
        corr .+= c9r[4] .* (rbinj4 .- rbij4)
        corr .+= c9r[8] .* (rbn2 .- rb2[:,i]) .* rb2[:,nei]
        corr .+= c9r[9] .* ( (rbn2 .+ rb2[:,nei]) .* rbinj2 .- (rb2[:,i] .+ rb2[:,nei]) .* rbij2 )
        corr = sumd(corr, 2)
        corr .+= (ne-1) .* c9r[5] .* (rbn2 .- rb2[:,i])
        corr .+= (ne-1) .* c9r[6] .* (rbn3 .- rb3[:,i])
        corr .+= (ne-1) .* c9r[7] .* (rbn4 .- rb4[:,i])
        ψn .*= exp.(corr)
        if i ≤ nα
            ns = nα
            isp = 1
            iαβ = 0
        else
            ns = ne - nα
            isp = 2
            iαβ = nα
        end
        ψsi, ∇ψsi, ∇²ψsi = stof(isp,rci,rn,sto)
        rno = zeros(nw)
        @inbounds for j = 1:ns
            rno .+= ψsi[:,j] .* ψ.ψ⁻¹s[isp][:,j,i-iαβ]
        end
        ψn .*= rno
        ψst = copy(ψ.ψs[isp])
        ψst[:,i-iαβ,:] = ψsi
        ψ⁻¹si = Array{Float64}(undef, nw, ns, ns)
        nei = 1:ns .≠ i-iαβ
        @inbounds @simd for ii = 1:ns
            if ii ≠ i-iαβ
                for jj = 1:ns
                    ψ⁻¹ψ = zeros(nw)
                    for kk = 1:ns
                        ψ⁻¹ψ .+= ψ.ψ⁻¹s[isp][:,jj,i-iαβ] .* ψsi[:,kk] .* ψ.ψ⁻¹s[isp][:,kk,ii]
                    end
                    ψ⁻¹si[:,jj,ii] .= ψ.ψ⁻¹s[isp][:,jj,ii] .- ψ⁻¹ψ ./ rno
                end
            else
                ψ⁻¹si[:,:,ii] .= ψ.ψ⁻¹s[isp][:,:,i-iαβ] ./ rno
            end
        end
    end
    return ψn, ψsi, ∇ψsi, ∇²ψsi, ψ⁻¹si
end

@fastmath @views function elocal(ψ::Ψstr, sto::STOstr, rc::Array{Float64,3}, c9r::Array{Float64,1})
    nw = size(ψ.ψ,1)
    zn, nα, ne = sto.zn, sto.nα, sto.ne
    ek = zeros(nw)
    vne = zeros(nw)
    vee = zeros(nw)
    ∂lψ∂m = zeros(nw, 9)
    ∂el∂m = zeros(nw, 9)
    rcij = Array{Float64}(undef, nw, 3)
    rij2 = Array{Float64}(undef, nw)
    rij = Array{Float64}(undef, nw)
    rij3 = Array{Float64}(undef, nw)
    rij4 = Array{Float64}(undef, nw)
    rdij = Array{Float64}(undef, nw)
    rdij2 = Array{Float64}(undef, nw)
    rdij3 = Array{Float64}(undef, nw)
    rdij4 = Array{Float64}(undef, nw)
    rdij5 = Array{Float64}(undef, nw)
    rdij6 = Array{Float64}(undef, nw)
    ririj = Array{Float64}(undef, nw)
    ∇ψc = Array{Float64}(undef, nw, 3)
    r2 = rc[:,:,1].^2 .+ rc[:,:,2].^2 .+ rc[:,:,3].^2
    r = sqrt.(r2)
    r3 = r .* r2
    r4 = r2.^2
    rd = (1 .+ r).^-1
    rd2 = rd.^2
    rd3 = rd .* rd2
    rd4 = rd2.^2
    rd5 = rd2 .* rd3
    rd6 = rd3.^2
    isp = 1
    iαβ = 0
    no = nα
    @inbounds for i = 1:ne
        i ≠ nα + 1 || ((isp, iαβ, no) = (2, nα, ne-nα))
        # Setting up determinant and correlation gradients.
        ∇ψd = zeros(nw,3)
        # Calculating gradient and kinetic energy for correlation,
        # parameters 5, 6, 7.
        ∇ψc .= (ne-1) .* rc[:,i,:] .* ( 2 .* c9r[5] .* rd3[:,i] .+
                                       3 .* c9r[6] .* r[:,i] .* rd4[:,i] .+
                                       4 .* c9r[7] .* r2[:,i] .* rd5[:,i] )
        ek .-= 0.5 .* (ne-1) .* ( 6 .* c9r[5] .* rd4[:,i] .+
                                 12 .* c9r[6] .* r[:,i] .* rd5[:,i] .+
                                 20 .* c9r[7] .* r2[:,i] .* rd6[:,i] )
        # ek[w] -= 0.5(ne-1) * ( 6c9r[5] / rdi4 +
        #                        12c9r[6] * ri/rdi5 +
        #                        20c9r[7] * ri2/rdi6 )
        # Setting up ∂ln(ψ)/∂cₘ gradient
        ∇∂lψ∂m = zeros(nw,3,9)
        # Calculating ∂ln(ψ)/∂cₘ gradient and ∂eₗ/∂cₘ,
        # parameters 5, 6, 7.
        ∇∂lψ∂m[:,:,5] .+= (ne-1) .* 2 .* rc[:,i,:] .* rd3[:,i]
        ∇∂lψ∂m[:,:,6] .+= (ne-1) .* 3 .* rc[:,i,:] .* r[:,i] .* rd4[:,i]
        ∇∂lψ∂m[:,:,7] .+= (ne-1) .* 4 .* rc[:,i,:] .* r2[:,i] .* rd5[:,i]
        ∂el∂m[:,5] .-= 0.5 .* (ne-1) .* 6 .* rd4[:,i]
        ∂el∂m[:,6] .-= 0.5 .* (ne-1) .* 12 .* r[:,i] .* rd5[:,i]
        ∂el∂m[:,7] .-= 0.5 .* (ne-1) .* 20 .* r2[:,i] .* rd6[:,i]
        # Setting ij variables
        #r2 = sumd(rc.^2, 3)
        #r = sqrt.(r2)
        for j = 1:no
            ∇ψd .+= ψ.ψ⁻¹s[isp][:,j,i-iαβ] .* ψ.∇ψs[isp][:,i-iαβ,j,:]
            ek .-= 0.5 .* ψ.ψ⁻¹s[isp][:,j,i-iαβ] .* ψ.∇²ψs[isp][:,i-iαβ,j]
        end
        @inbounds for j = 1:ne
            if j == i
                continue
            end
            # Differentiating like and unlik spin electrons.
            # if (i ≤ nα && j ≤ nα) || (i > nα && j > nα)
            #     ees = 0.5
            # else
                ees = 1.0
            # end
            # Setting up electrons ij variables
            rcij .= rc[:,i,:] .- rc[:,j,:]
            rij2 .= rcij[:,1].^2 .+ rcij[:,2].^2 .+ rcij[:,3].^2
            rij .= sqrt.(rij2)
            rij3 .= rij .* rij2
            rij4 .= rij2.^2
            rdij .= (1 .+ rij).^-1
            rdij2 .= rdij.^2
            rdij3 .= rdij .* rdij2
            rdij4 .= rdij2.^2
            rdij5 .= rdij2 .* rdij3
            rdij6 .= rdij3.^2
            ririj .= rc[:,i,1] .* rcij[:,1] .+ rc[:,i,2] .* rcij[:,2] .+ rc[:,i,3] .* rcij[:,3]
            # Calculating gradient and kinetic energy for correlation,
            # parameters 1, 2, 3, 4, 8, 9.
            ∇ψc .+= rc[:,i,:] .* ( 2c9r[8] .* r2[:,j] .* rd2[:,j] .* rd3[:,i] .+
                                   2c9r[9] .* rij2 .* rdij2 .* rd3[:,i] )
            ∇ψc .+= rcij .* ( c9r[1] .* ees .* rdij2 ./ rij .+
                              2c9r[2] .* rdij3 .+
                              3c9r[3] .* rij .* rdij4 .+
                              4c9r[4] .* rij2 .* rdij5 .+
                              2c9r[9] .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j]) .* rdij3 )
            ek  .-= 0.5( 2c9r[1] .* ees .* rdij3 ./ rij .+
                         6c9r[2] .* rdij4 .+
                        12c9r[3] .* rij .* rdij5 .+
                        20c9r[4] .* rij2 .* rdij6 .+
                         6c9r[8] .* r2[:,j] .* rd2[:,j] .* rd4[:,i] .+
                         2c9r[9] .* ( 3 .* rij2 .* rdij2 .* rd4[:,i] .+
                                      4 .* ririj .* rd3[:,i] .* rdij3 .+
                                      3 .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j]) .* rdij4 ))
            # Calculating ∂ln(ψ)/∂cₘ
            ∂lψ∂m[:,1] .+= 0.5 .* rij .* rdij
            ∂lψ∂m[:,2] .+= 0.5 .* rij2 .* rdij2
            ∂lψ∂m[:,3] .+= 0.5 .* rij3 .* rdij3
            ∂lψ∂m[:,4] .+= 0.5 .* rij4 .* rdij4
            ∂lψ∂m[:,5] .+= 0.5 .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j])
            ∂lψ∂m[:,6] .+= 0.5 .* (r3[:,i].*rd3[:,i] .+ r3[:,j].*rd3[:,j])
            ∂lψ∂m[:,7] .+= 0.5 .* (r4[:,i].*rd4[:,i] .+ r4[:,j].*rd4[:,j])
            ∂lψ∂m[:,8] .+= 0.5 .* r2[:,i].*rd2[:,i] .* r2[:,j].*rd2[:,j]
            ∂lψ∂m[:,9] .+= 0.5 .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j]) .* rij2.*rdij2
            # Calculating ∂ln(ψ)/∂cₘ gradient and ∂eₗ/∂cₘ,
            # parameters 1, 2, 3, 4, 8, 9.
            ∇∂lψ∂m[:,:,1] .+= rcij .* rdij2 ./ rij
            ∇∂lψ∂m[:,:,2] .+= rcij .* 2 .* rdij3
            ∇∂lψ∂m[:,:,3] .+= rcij .* 3 .* rij .* rdij4
            ∇∂lψ∂m[:,:,4] .+= rcij .* 4 .* rij2 .* rdij5
            ∇∂lψ∂m[:,:,8] .+= rc[:,i,:] .* 2 .* r2[:,j] .* rd2[:,j] .* rd3[:,i]
            ∇∂lψ∂m[:,:,9] .+= rc[:,i,:] .* 2 .* rij2 .* rdij2 .* rd3[:,i] .+
                              rcij .* 2 .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j]) .* rdij3
            ∂el∂m[:,1] .-= 0.5 *  2 .* rdij3 ./ rij
            ∂el∂m[:,2] .-= 0.5 *  6 .* rdij4
            ∂el∂m[:,3] .-= 0.5 * 12 .* rij .* rdij5
            ∂el∂m[:,4] .-= 0.5 * 20 .* rij2 .* rdij6
            ∂el∂m[:,8] .-= 0.5 *  6 .* r2[:,j] .* rd2[:,j] .* rd4[:,i]
            ∂el∂m[:,9] .-= 0.5 *  2 .* ( 3 .* rij2 .* rdij2 .* rd4[:,i] .+
                                         4 .* ririj .* rd3[:,i] .* rdij3 .+
                                         3 .* (r2[:,i].*rd2[:,i] .+ r2[:,j].*rd2[:,j]) .* rdij4 )
            # Calculating electron-electron repulsion energy
            vee .+= 0.5 .* rij.^-1
        end
        # Calculating ∂eₗ/∂cₘ for gradients of determinant, correlation, eₗ.
        @inbounds for k = 1:3
            ∂el∂m[:,1] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,1]
            ∂el∂m[:,2] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,2]
            ∂el∂m[:,3] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,3]
            ∂el∂m[:,4] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,4]
            ∂el∂m[:,5] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,5]
            ∂el∂m[:,6] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,6]
            ∂el∂m[:,7] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,7]
            ∂el∂m[:,8] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,8]
            ∂el∂m[:,9] .-= 0.5 * 2 .* (∇ψd[:,k] .+ ∇ψc[:,k]) .* ∇∂lψ∂m[:,k,9]
            ek .-= (∇ψd[:,k] .+ 0.5 .* ∇ψc[:,k]) .* ∇ψc[:,k]
        end
        # Calculating kinetic energy for gradients of determinant, correlation.
        # Calculating nuclear-electron attraction energy
        vne .-= zn .* r[:,i].^-1
    end
    el = ek .+ vne .+ vee
    return (el, ek, vne, vee, ∂lψ∂m, ∂el∂m)
end

@fastmath @views function vqmcnr(qmcp::QMCstr, sto::STOstr, corp::Corstr)
    # Setting initial seed
    nw    = qmcp.nw
    tnstp = qmcp.tnstp
    nstp  = qmcp.nstp
    τ     = qmcp.τ
    acc   = qmcp.acc
    nrstp = qmcp.nrstp
    Δlim  = qmcp.Δlim
    c9, c9i = corp.c9, corp.c9i

    Enrf = Array{Float64}(undef, nrstp)
    σnrf = Array{Float64}(undef, nrstp)
    Ekf  = Array{Float64}(undef, nrstp)
    Vnef = Array{Float64}(undef, nrstp)
    Veef = Array{Float64}(undef, nrstp)
    Vtf  = Array{Float64}(undef, nrstp)
    c9f  = Array{Float64}(undef, 9, nrstp)
    fmf  = Array{Float64}(undef, 9, nrstp)
    hmnf = Array{Float64}(undef, 9, 9, nrstp)
    μ∂lψ∂mf      = Array{Float64}(undef, 9, nrstp)
    μ∂el∂mf      = Array{Float64}(undef, 9, nrstp)
    μel∂lψ∂mf    = Array{Float64}(undef, 9, nrstp)
    μ∂²lψ∂mnf    = Array{Float64}(undef, 9, 9, nrstp)
    μel∂²lψ∂mnf  = Array{Float64}(undef, 9, 9, nrstp)
    μ∂el∂m∂lψ∂nf = Array{Float64}(undef, 9, 9, nrstp)

    c9   = corp.c9
    τ    = qmcp.τ
    acc = qmcp.acc
    nα, ne = sto.nα, sto.ne
    inr  = 0
    swt  = 1
    τr   = 0.0 # only to initialize as Float64
    accr = 0.0 # only to initialize as Float64
    c9r  = copy(c9)
    rc   = Array{Float64}(undef, nw, ne, 3)
    # default(legend = false)
    # Starting main loop
    while inr ≠ nrstp
        # Prepering thermalization or main calculation
        if swt == 1
            nrun = tnstp
            τr   = copy(τ)
            accr = copy(acc)
            rc   = randn(Float64, nw, ne, 3)
            println("-"^60)
            println("")
            println("Starting Thermalization of Step $(inr+1)")
            println("")
        else
            nrun = nstp
            inr += 1
            println("-"^60)
            println("")
            println("Starting VQMC of Step $inr")
            println("")
        end
        
        # aict = Array{Float64}(undef, div(nrun,100))
        # Enct = Array{Float64}(undef, div(nrun,100))
        # First wave and energy estimations
        ψo = wavef(rc,sto,c9r)
        el, ek, vne, vee, ∂lψ∂m, ∂el∂m = elocal(ψo, sto, rc, c9r)
        # Intial cycle VQMC variables
        μel = sum(el)/nw
        μel² = sum(el.^2)/nw
        μek = sum(ek)/nw
        μvne = sum(vne)/nw
        μvee = sum(vee)/nw
        ict = 1
        en = μel/ict
        σen = sqrt( (μel²/ict - en.^2) / (ict*nw - 1) )
        ekt = μek/ict
        vnet = μvne/ict
        veet = μvee/ict
        vt = vnet + veet
        if swt ≠ 1
            # Setting initil variables of VMQ cicles
            μ∂lψ∂m = sumd(∂lψ∂m, 1)./nw
            μ∂el∂m = sumd(∂el∂m, 1)./nw
            μel∂lψ∂m = sumd(el .* ∂lψ∂m, 1) ./ nw
            μ∂²lψ∂mn = ∂lψ∂m' * ∂lψ∂m ./ nw
            μel∂²lψ∂mn = (el.*∂lψ∂m)' * ∂lψ∂m ./ nw
            μ∂el∂m∂lψ∂n = (∂el∂m' * ∂lψ∂m .+ ∂lψ∂m' * ∂el∂m) ./ nw
        end
        while ict ≠ nrun
            ict += 1
            nacc = 0
            isp = 1
            iαβ = 0
            @inbounds for i = 1:ne
                i ≠ nα + 1 || ((isp, iαβ) = (2, nα))
                rci = rc[:,i,:] .+ τr.*(0.5 .- rand(nw,3))
                ψi, ψsi, ∇ψsi, ∇²ψsi, ψ⁻¹si = wavefup(i,rci,ψo,rc,sto,c9r)
                ψtrans = ψi.^2 ./ ψo.ψ.^2
                iacc = ψtrans .≥ rand(nw)
                nacc += sum(iacc)/ne
                rc[iacc,i,:] = rci[iacc,:]
                ψo.ψ[iacc] = ψi[iacc]
                ψo.ψs[isp][iacc,i-iαβ,:] = ψsi[iacc,:]
                ψo.∇ψs[isp][iacc,i-iαβ,:,:] = ∇ψsi[iacc,:,:]
                ψo.∇²ψs[isp][iacc,i-iαβ,:] = ∇²ψsi[iacc,:]
                ψo.ψ⁻¹s[isp][iacc,:,:] = ψ⁻¹si[iacc,:,:]
            end
            acc = nacc/nw
            el, ek, vne, vee, ∂lψ∂m, ∂el∂m = elocal(ψo, sto, rc, c9r)
            μel += sum(el)/nw
            μel² += sum(el.^2)/nw
            μek += sum(ek)/nw
            μvne += sum(vne)/nw
            μvee += sum(vee)/nw
            if swt ≠ 1
                μ∂lψ∂m .+= sumd(∂lψ∂m, 1)./nw
                μ∂el∂m .+= sumd(∂el∂m, 1)./nw
                μel∂lψ∂m .+= sumd(el .* ∂lψ∂m, 1) ./ nw
                μ∂²lψ∂mn .+= ∂lψ∂m' * ∂lψ∂m ./ nw
                μel∂²lψ∂mn .+= (el.*∂lψ∂m)' * ∂lψ∂m ./ nw
                μ∂el∂m∂lψ∂n .+= (∂el∂m' * ∂lψ∂m .+ ∂lψ∂m' *∂el∂m) ./ nw
            end
            en = μel/ict
            σen = sqrt( (μel²/ict - en.^2) / (ict*nw - 1) )
            ekt = μek/ict
            vnet = μvne/ict
            veet = μvee/ict
            vt = vnet + veet
            if ict % 100 == 0
                # aict[div(ict,100)] = ict/100
                # Enct[div(ict,100)] = en
                # print(μel," ",en,"\n")
                printprg(en,σen,acc,τr,ict,nrun)
                # display( plot(aict[1:div(ict,100)],Enct[1:div(ict,100)], ylims = (-2.861679995612-0.0005,-2.861679995612+0.0005) ))
                # println("-------------------------------------------------------")
                # println("E = $en ± $σen")
                # println("Step = $ict")
                # println("Acceptance = $acc")
                # println("τ = $τr")
                τr = acc*τr/accr
            end
        end
        if swt == 1
            swt = 0
        else
            swt = 1
            Enrf[inr] = en
            σnrf[inr] = σen
            Ekf[inr] = ekt
            Vnef[inr] = vnet
            Veef[inr] = veet
            Vtf[inr] = vt
            c9f[:,inr] = c9r
            μ∂lψ∂mf[:,inr] = μ∂lψ∂m
            μ∂el∂mf[:,inr] = μ∂el∂m
            μel∂lψ∂mf[:,inr] = μel∂lψ∂m
            μ∂²lψ∂mnf[:,:,inr] = μ∂²lψ∂mn
            μel∂²lψ∂mnf[:,:,inr] = μel∂²lψ∂mn
            μ∂el∂m∂lψ∂nf[:,:,inr] = μ∂el∂m∂lψ∂n
            fmr = zeros(9)
            @inbounds for mk = 1:9
                fmr[mk] = 2( μel∂lψ∂m[mk] - en*μ∂lψ∂m[mk] ) / nstp
            end
            hmnr = zeros(9,9)
            @inbounds for mk = 1:9
                for nk = 1:9
                    hmnr[mk,nk] = ( 4(μel∂²lψ∂mn[mk,nk] - en*μ∂²lψ∂mn[mk,nk]) -
                                    2(μ∂lψ∂m[mk]*fmr[nk] + μ∂lψ∂m[nk]*fmr[mk]) +
                                    μ∂el∂m∂lψ∂n[mk,nk] -
                                    (μ∂el∂m[mk]*μ∂lψ∂m[nk] + μ∂el∂m[nk]*μ∂lψ∂m[mk]) / nstp
                                    ) / nstp
                end
            end
            fmf[:,inr] = fmr
            display( plot( plot(c9f[:,1:inr]', marker=(:dot,3)),
                           plot(fmf[:,1:inr]', marker=(:dot,3)) ) )
            hmnf[:,:,inr] = hmnr
            if sum(c9i) ≠ 0
                eigd, eigv = eigen(hmnr[c9i,c9i])
                hmnc⁻¹ = eigv*diagm(abs.(eigd.^-1))*eigv'
                Δc9 = - hmnc⁻¹*fmr[c9i]
                MΔc9 = maximum(abs.(Δc9))
                if MΔc9 > Δlim
                    Δc9 = Δlim*Δc9/MΔc9
                end
                # Δc9[abs.(Δc9) .> 1] .= sign.(Δc9[abs.(Δc9) .> 1])
                c9r[c9i] += Δc9
            end
        end
    end
    return Corstr(c9r,c9i), NRstr(Enrf, σnrf, Ekf, Vnef, Veef, Vtf, c9f, fmf, hmnf),
           NRμstr(μ∂lψ∂mf, μ∂el∂mf, μel∂lψ∂mf, μ∂²lψ∂mnf, μel∂²lψ∂mnf, μ∂el∂m∂lψ∂nf)
end

function main(fout::String, atom::Int, ion::Int, spin::Char, base::String)
    nra = Array{NRstr}(undef, 0)
    nrμa = Array{NRμstr}(undef, 0)
    qmcpa = Array{QMCstr}(undef, 0)
    stoa = Array{STOstr}(undef, 0)
    corpa = Array{Corstr}(undef, 0)
    qmcp, sto, corp = qmcinp(true, true, atom, ion, spin, base)
    push!(qmcpa, qmcp)
    push!(stoa, sto)
    push!(corpa, corp)
    c9s, o1, o2 = vqmcnr(qmcp, sto, corp)
    push!(nra, o1)
    push!(nrμa, o2)
    save(fout, "nr", nra, "qmcp", qmcpa, "sto", stoa, "corp", corpa, "c9s", c9s, "nrμ", nrμa)
    return c9s, nra, qmcpa, stoa, corpa, nrμa
end

function main(fout::String, c9s::Corstr, nr::Array{NRstr}, qmcp::Array{QMCstr}, sto::Array{STOstr}, corp::Array{Corstr}, nrμ::Array{NRμstr}, atom::Int, ion::Int, spin::Char, base::String)
    qmcpn, ston = qmcinp(true, false, atom, ion, spin, base)
    push!(qmcp, qmcpn)
    push!(sto, ston)
    push!(corp, c9s)
    c9s, o1, o2 = vqmcnr(qmcpn, ston, c9s)
    push!(nr, o1)
    push!(nrμ, o2)
    save(fout, "nr", nr, "qmcp", qmcp, "sto", sto, "corp", corp, "c9s", c9s, "nrμ", nrμ)
    return c9s
end

function main(fout::String, atom::Int, ion::Int, spin::Char, base::String, script::Int)
    nra = Array{NRstr}(undef, 0)
    nrμa = Array{NRμstr}(undef, 0)
    qmcpa = Array{QMCstr}(undef, 0)
    stoa = Array{STOstr}(undef, 0)
    corpa = Array{Corstr}(undef, 0)
    println("Enter seed number:")
    seed = parse(Int,readline())
    Random.seed!(seed)
    qmcp = QMCstr(
        100, # nw
        seed, # seed
        100, # tnstp
        1000, # nstp
        1., # τ
        .5, # acc
    20, # nrstp
    1. # Δlim
    )
    sto, corp = qmcinp(false, true, atom, ion, spin, base)
    push!(qmcpa, qmcp)
    push!(stoa, sto)
    push!(corpa, corp)
    c9s, o1, o2 = vqmcnr(qmcp, sto, corp)
    push!(nra, o1)
    push!(nrμa, o2)
    save(fout, "nr", nra, "qmcp", qmcpa, "sto", stoa, "corp", corpa, "c9s", c9s, "nrμ", nrμa)

    qmcp = QMCstr(
        100, # nw
        seed, # seed
        1000, # tnstp
        20000, # nstp
        1., # τ
        .5, # acc
    5, # nrstp
    1. # Δlim
    )
    sto = qmcinp(false, false, atom, ion, spin, base)
    push!(qmcpa, qmcp)
    push!(stoa, sto)
    push!(corpa, c9s)
    c9s, o1, o2 = vqmcnr(qmcp, sto, c9s)
    push!(nra, o1)
    push!(nrμa, o2)
    save(fout, "nr", nra, "qmcp", qmcpa, "sto", stoa, "corp", corpa, "c9s", c9s, "nrμ", nrμa)

    qmcp = QMCstr(
        100, # nw
        seed, # seed
        1000, # tnstp
        20000, # nstp
        1., # τ
        .5, # acc
    20, # nrstp
    1. # Δlim
    )
    sto = qmcinp(false, false, atom, ion, spin, base)
    push!(qmcpa, qmcp)
    push!(stoa, sto)
    push!(corpa, c9s)
    c9s, o1, o2 = vqmcnr(qmcp, sto, c9s)
    push!(nra, o1)
    push!(nrμa, o2)
    save(fout, "nr", nra, "qmcp", qmcpa, "sto", stoa, "corp", corpa, "c9s", c9s, "nrμ", nrμa)

    c9s = Corstr(sumd(nra[3].c9[:,:], 2) / size(nra[3].E[:], 1), c9s.c9i)

    qmcp = QMCstr(
        100, # nw
        seed, # seed
        5000, # tnstp
        200000, # nstp
        1., # τ
        .5, # acc
    1, # nrstp
    1. # Δlim
    )
    sto = qmcinp(false, false, atom, ion, spin, base)
    push!(qmcpa, qmcp)
    push!(stoa, sto)
    push!(corpa, c9s)
    c9s, o1, o2 = vqmcnr(qmcp, sto, c9s)
    push!(nra, o1)
    push!(nrμa, o2)
    save(fout, "nr", nra, "qmcp", qmcpa, "sto", stoa, "corp", corpa, "c9s", c9s, "nrμ", nrμa)

    return c9s, nra, qmcpa, stoa, corpa, nrμa
end
