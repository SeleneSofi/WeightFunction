x0 = [
       nGuma(
              1,
              1,
              [],
              [1.0230,1.0230,1.0230],
              [0.8222,0.07866,0.09911],
              [4.3887,5.5401,3.8290]
       )
       nGuma(
              2,
              1,
              [2.8254],
              [1.1806,1.1806,1.1806,1.1806],
              [0.01895,0.05596,0.6519,0.2732],
              [1.5808,5.4663,3.2625,2.2361]
       )
       nGuma(
              3,
              1,
              [0.3808,2.7879],
              [0.8762,0.8762,0.8762,0.8762],
              [0.0004003,0.2140,0.7765,0.009073],
              [0.1498,1.7912,3.6543,0.8171]
       )
       nGuma(
              2,
              2,
              [],
              [0.9857,0.9857,0.9857,0.9857],
              [0.02748,0.3605,0.5207,0.09132],
              [1.7260,2.3995,3.4620,5.0733]
       )
       nGuma(
              3,
              2,
              [0.8395],
              [0.8573,0.8573,0.8573,0.8573],
              [0.2692,0.7118,0.0008018,0.01812],
              [1.7246,3.2818,-0.2530,0.6657]
       )
]

x0 = [
       nGum(
              1,
              1,
              1,
              [],
              [0.01,0.1,1,0.1],
              [2.4,3.4,4.4,5.4]
       )
       nGum(
              1,
              2,
              1,
              [2.8],
              [0.01,0.01,1,0.1],
              [1.6,2.2,3.3,5.4]
       )
       nGum(
              1,
              3,
              1,
              [0.4,2.8],
              [0.01,0.1,0.1,1],
              [0,1,2,3.3]
       )
       nGum(
              1,
              2,
              2,
              [],
              [0.01,0.1,1,0.1],
              [1.6,2.6,3.6,5]
       )
       nGum(
              1,
              3,
              2,
              [0.84],
              [0.01,0.1,1,0.1],
              [0,1,2,3]
       )
]

op = [
       nGuma_opt([],   [0,0,0,0],[0,1,1,1],[1,1,1,1]),
       nGuma_opt([0],  [0,0,0,0],[0,0,0,0],[0,0,0,0]),
       nGuma_opt([0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]),
       nGuma_opt([],   [0,0,0,0],[0,0,0,0],[0,0,0,0]),
       nGuma_opt([0],  [0,0,0,0],[0,0,0,0],[0,0,0,0])
]

op0 = [
       nSig_opt(0,0,[],   [0,0,0,0],[0,0,0,0]),
       nSig_opt(0,0,[0],  [0,0,0,0],[0,0,0,0]),
       nSig_opt(0,0,[0,0],[0,0,0,0],[0,0,0,0]),
       nSig_opt(0,0,[],   [0,0,0,0],[0,0,0,0]),
       nSig_opt(0,0,[0],  [0,0,0,0],[0,0,0,0])
]

begin
       op = copy(op0)
       op[1] = nGum_opt(1,[],   [1,1,1,1],[1,1,1,1])
       f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-13, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x0 = get_x(results.minimizer, fixparams[1:2]...)
       op = copy(op0)
       op[2] = nGum_opt(1,[1],   [1,1,1,1],[1,1,1,1])
       f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-13, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x0 = get_x(results.minimizer, fixparams[1:2]...)
       op = copy(op0)
       op[3] = nGum_opt(1,[1,1],   [1,1,1,1],[1,1,1,1])
       f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-13, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x0 = get_x(results.minimizer, fixparams[1:2]...)
       op = copy(op0)
       op[4] = nGum_opt(1,[],   [1,1,1,1],[1,1,1,1])
       f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-13, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x0 = get_x(results.minimizer, fixparams[1:2]...)
       op = copy(op0)
       op[5] = nGum_opt(1,[1],   [1,1,1,1],[1,1,1,1])
       f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-13, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x0 = get_x(results.minimizer, fixparams[1:2]...)
end




3.806150e-06
nGum(1.024409062612785, 1, 1, Float64[], [0.00016978454993833302, 0.1306227041119264, 0.7932016322785495, 0.07597871891010537], [2.1525272059745344, 3.8904065652589614, 4.4035948041298, 5.564056829177059])
nGum(1.1072548813682215, 2, 1, [2.8161776619660666], [0.039985457349461774, 0.5583598194940049, 1.3400012020115484, 0.1778366764834064], [1.7136448764953214, 2.3496444921081747, 3.4221370017188355, 5.32794840481829])
nGum(0.8765395085116796, 3, 1, [0.38096503308607804, 2.7880905355335104], [0.0004739345858995951, 0.011228751793064871, 0.2733708855751731, 0.9838520887401521], [0.13737541485733049, 0.8020642622297137, 1.7842595396312382, 3.6490999840078913])
nGum(1.0021857593894976, 2, 2, Float64[], [0.0318135028929959, 0.37717985368587387, 0.5556218627876994, 0.10870037862270177], [1.7084251425965418, 2.3825924661655233, 3.4458544414563663, 5.043195392253833])
nGum(0.9484054253248536, 3, 2, [0.9702917893639799], [0.009694360155368998, 0.22579014438702533, 2.9747603013491344, 6.63035994574347], [-0.580341188285041, 0.31435354060872683, 1.3355512318261205, 3.1763287185913396])

deltz = +2*log(17/18)

ETabn(-5+deltz,20,50),
ETabn(-5+deltz,15,40)

deltz = +2*log(17/18)

nGum(1.0 , 1, 1, Float64[],          [0.00017, 0.13,  0.79,  0.076], [2.15,  3.9,   4.4,  5.55].+deltz)
nGum(1.1 , 2, 1, [2.8].+deltz,       [0.040,   0.56,  1.3,   0.18],  [1.7,   2.35,  3.4,  5.3] .+deltz)
nGum(0.88, 3, 1, [0.38, 2.8].+deltz, [0.00047, 0.011, 0.27,  0.98],  [0.14,  0.80,  1.8,  3.64].+deltz)
nGum(1.0 , 2, 2, Float64[],          [0.032,   0.38,  0.555, 0.11],  [1.7,   2.4,   3.45, 5.05].+deltz)
nGum(0.95, 3, 2, [0.97].+deltz,      [0.0097,  0.225, 3.0,   6.6],   [-0.58, 0.315, 1.3,  3.2] .+deltz)

3.128952e-06
nGum(1.037776874363138, 1, 1, Float64[], [0.00013861623343809743, 0.10169600038383528, 0.25305991151097, 0.027276709544310874], [1.9746084639644148, 3.8805559310074513, 4.354501702312852, 5.596169622970401])
nGum(1.0884870890369094, 2, 1, [2.6909713401490905], [0.04193646369801634, 0.5020537350854865, 1.3540248363593808, 0.21087412664739247], [1.6223293382309993, 2.241410907257396, 3.329791713397741, 5.144816933238555])
nGum(0.8659699864335028, 3, 1, [0.20314320547497597, 2.668120929113391], [0.0005139119151314762, 0.011366497369528298, 0.27251556707812763, 1.1181277634086684], [-0.008461833430041412, 0.6341192004065005, 1.6151510808993153, 3.4907469113353202])
nGum(0.9931715108370172, 2, 2, Float64[], [0.028766749064084888, 0.33033064687098157, 0.5333475001905412, 0.10909456107943008], [1.5608548558290212, 2.233936113133386, 3.3020647124742637, 4.882063353914733])
nGum(0.8432748059571739, 3, 2, [0.647494931306578], [0.002224086590068394, 0.04467208372844291, 0.6234434509655197, 1.9265466215689095], [-0.3775480629277108, 0.5244903062721005, 1.57723026771834, 3.1548181732605998])

deltz = +2*log(16/18)

ETabn(-5+deltz,20,50),
ETabn(-5+deltz,15,40)

deltz = +2*log(16/17)

nGum(1.0,   1, 1, Float64[],           [0.00014, 0.10,  0.25, 0.027], [2.0,      3.9,   4.35, 5.6] .+deltz)
nGum(1.1,   2, 1, [2.7].+deltz,        [0.042,   0.50,  1.35, 0.21],  [1.6,      2.2,   3.3,  5.1] .+deltz)
nGum(0.865, 3, 1, [0.20, 2.65].+deltz, [0.00051, 0.011, 0.27, 1.1],   [-0.00845, 0.63,  1.6,  3.5] .+deltz)
nGum(0.99,  2, 2, Float64[],           [0.029,   0.33,  0.53, 0.11],  [1.55,     2.2,   3.3,  4.9] .+deltz)
nGum(0.84,  3, 2, [0.65].+deltz,       [0.0022,  0.045, 0.62, 1.9],   [-0.38,    0.525, 1.6,  3.15].+deltz)

2.472080e-06
nGum(1.0380570023202944, 1, 1, Float64[], [0.00012745213569884004, 0.09793875254428208, 0.27899610110712814, 0.031827324820586124], [1.8739790170443988, 3.7341640218968575, 4.216322802133998, 5.4476599810059305])
nGum(1.1052848770803372, 2, 1, [2.564755849912061], [0.05935050399084427, 0.6029321649161815, 1.7574230523761978, 0.25983601131303397], [1.4507112696738325, 2.0671739304423853, 3.1355971439840564, 5.0428931431525506])
nGum(0.8546072013386912, 3, 1, [0.004573413646056729, 2.5425421236836088], [0.0011883674581505278, 0.020055285683377614, 0.42361893815662, 2.0877428502274813], [-0.12288387798410375, 0.5122427784336998, 1.4689113328929593, 3.3050550402080443])
nGum(0.9791325675558307, 2, 2, Float64[], [0.027893467304725316, 0.3184388008302484, 0.5685613507476035, 0.11951195945237018], [1.402012781650732, 2.0765017772104963, 3.153235806352555, 4.737494484432226])
nGum(0.827133364157393, 3, 2, [0.4370924485656681], [0.0030538372806095146, 0.05036301792762683, 0.6121222001799503, 2.2783222247043535], [-0.4891074479381257, 0.37708374432482017, 1.4103263535534682, 3.0184299286690726])

deltz = +2*log(15/18)

ETabn(-5+deltz,20,50),
ETabn(-5+deltz,15,40)

deltz = +2*log(15/16)

nGum(1.0,   1, 1, Float64[],              [0.00013, 0.098, 0.28, 0.032], [1.9,   3.7,  4.2,  5.45].+deltz)
nGum(1.1,   2, 1, [2.55].+deltz,          [0.059,   0.60,  1.75, 0.26],  [1.45,  2.1,  3.1,  5.05].+deltz)
nGum(0.855, 3, 1, [0.0046, 2.55].+deltz,  [0.0012,  0.020, 0.42, 2.1],   [-0.12, 0.51, 1.5,  3.3] .+deltz)
nGum(0.98,  2, 2, Float64[],              [0.028,   0.32,  0.57, 0.12],  [1.4,   2.1,  3.15, 4.7] .+deltz)
nGum(0.83,  3, 2, [0.44].+deltz,          [0.00305, 0.050, 0.61, 2.3],   [-0.49, 0.38, 1.4,  3.0] .+deltz)

1.950768e-06
nGum(1.0381684123337984, 1, 1, Float64[], [8.179152463154324e-5, 0.06507357344000192, 0.22222145381192535, 0.026980019491031716], [1.6638476732843024, 3.5721376277233707, 4.0662199816449585, 5.286210953059091])
nGum(1.0893615022370715, 2, 1, [2.424277145210041], [0.09489129944091806, 0.8188213689731797, 2.692681418829908, 0.4524035614419704], [1.3242004812492425, 1.9354356516549402, 3.007708582944086, 4.8574690482383325])
nGum(0.8426738774165659, 3, 1, [-0.21958783879074567, 2.4065845397956127], [0.00146444280756039, 0.018263994709353, 0.3755767333140067, 2.2412835721882227], [-0.28192467678987987, 0.315117817110562, 1.264095946120605, 3.124298321245187])
nGum(0.9645036942040528, 2, 2, Float64[], [0.01851947154403941, 0.19869185687957555, 0.39677065882262663, 0.08640839985738555], [1.2342621128699025, 1.9095229778191694, 2.9956545230402214, 4.586640785567537])
nGum(0.806377609754288, 3, 2, [0.19087483963975205], [0.0044943263319216905, 0.05295680588601061, 0.4768370209167695, 2.246197910243795], [-0.5426190016161936, 0.25676828896909426, 1.2552032786819982, 2.8761653735608577])

deltz = +2*log(14/18)

ETabn(-5+deltz,20,50),
ETabn(-5+deltz,15,40)

deltz = +2*log(14/15)

nGum(1.05, 1, 1, Float64[],             [8.2e-5,  0.065, 0.22,  0.027],  [1.7,   3.6,   4.05, 5.3] .+deltz)
nGum(1.1, 2, 1, [2.4].+deltz,           [0.095,   0.82,  2.7,   0.45],   [1.3,   1.9,   3.0,  4.85].+deltz)
nGum(0.84, 3, 1, [-0.22, 2.405].+deltz, [0.00145, 0.018, 0.375, 2.2],    [-0.28, 0.315, 1.25, 3.1] .+deltz)
nGum(0.965, 2, 2, Float64[],            [0.0185,  0.20,  0.40,  0.0865], [1.2,   1.9,   3.0,  4.6] .+deltz)
nGum(0.805, 3, 2, [0.19].+deltz,        [0.0045,  0.053, 0.475, 2.25],   [-0.54, 0.26,  1.25, 2.9] .+deltz)

1.721874e-06
nGum(1.036736040311461, 1, 1, Float64[], [5.6588247779380084e-5, 0.046152550984420795, 0.19940014216152568, 0.025692192370741523], [1.4413767023540358, 3.3938407302140736, 3.9041396157654886, 5.108440958654158])
nGum(1.0944994618331305, 2, 1, [2.277930212298031], [0.10578835489840901, 0.7903202100145854, 2.858253430585481, 0.46587071863032864], [1.1360295983063313, 1.7574774753955849, 2.8087724323804157, 4.723006187621585])
nGum(0.8317171935087682, 3, 1, [-0.47751480987077877, 2.2609690213897013], [0.002783530366238124, 0.03315773170091864, 0.6786995217405288, 5.048317471371979], [-0.5258864405394472, 0.03784140830438755, 1.0041352750598587, 2.9172120856099015])
nGum(0.9439853280053901, 2, 2, Float64[], [0.01699723584924107, 0.17565092614955088, 0.39930033135537496, 0.08901787590288311], [1.0489068388256624, 1.729077358285667, 2.827724365810156, 4.424950253504199])
nGum(0.7865221106387782, 3, 2, [-0.07889394418429405], [0.005295749124463967, 0.051477038776917484, 0.43543803727133296, 2.5405719856270417], [-0.7579416382619288, 0.05658194327857452, 1.069094365762603, 2.7355549591876263])

deltz = +2*log(13/18)

ETabn(-5+deltz,20,50),
ETabn(-5+deltz,15,40)

deltz = +2*log(13/14)

nGum(1.0,   1, 1, Float64[],           [5.65e-5, 0.046,  0.20,  0.0255], [1.45,   3.4,    3.9,  5.1].+deltz)
nGum(1.1,   2, 1, [2.3].+deltz,        [0.105,   0.79,   2.85,  0.465],  [1.1,    1.75,   2.8,  4.7].+deltz)
nGum(0.83,  3, 1, [-0.48, 2.3].+deltz, [0.0028,  0.033,  0.68,  5.05],   [-0.525, 0.038,  1.0,  2.9].+deltz)
nGum(0.94,  2, 2, Float64[],           [0.017,   0.175,  0.40,  0.089],  [1.05,   1.7,    2.8,  4.4].+deltz)
nGum(0.785, 3, 2, [-0.079].+deltz,     [0.0053,  0.0515, 0.435, 2.55],   [-0.76,  0.0565, 1.05, 2.7].+deltz)

1.690311e-06
nGum(1.0429280423963094, 1, 1, Float64[], [5.9609140303717833e-5, 0.043556589546476975, 0.14238027313640594, 0.020402615400587038], [1.5801525541118524, 3.2711691466000894, 3.772157943446419, 4.990844398028361])
nGum(1.1118549178685457, 2, 1, [2.121025762760528], [0.09794542272650462, 0.7054307050900834, 2.827487003377494, 0.4257509682669765], [0.8860895150516378, 1.5385196334309883, 2.572695901506996, 4.592804164017044])
nGum(0.817684256227421, 3, 1, [-0.7883920762862326, 2.103527032232952], [0.004845162792117035, 0.04569045536938916, 0.8411821095492507, 8.313959335243664], [-0.7822243135891781, -0.23705965786235914, 0.7323302713216929, 2.706242115932833])
nGum(0.913631599923967, 2, 2, Float64[], [0.014684357129832211, 0.15015976261809377, 0.3964821440870426, 0.08685421466802458], [0.8480071207687256, 1.5392309562975166, 2.655734569081258, 4.269701667369046])
nGum(0.7628106793181337, 3, 2, [-0.40279906475969696], [0.006742577166450707, 0.052858380529146376, 0.414461225450836, 3.1014111491111223], [-1.0344121444173244, -0.1547672932397629, 0.8834067016134193, 2.591005509918367])

ETabn(-5.2,20,50),
ETabn(-5.2,15,40)

deltz = +2*log(13/14)

nGum(1.05, 1, 1, Float64[],           [5.95e-5, 0.0435, 0.14,  0.0205], [1.6,    3.3,  3.8,  5.0].+deltz)
nGum(1.1,  2, 1, [2.1].+deltz,        [0.098,   0.705,  2.8,   0.425],  [0.89,   1.55, 2.6,  4.6].+deltz)
nGum(0.82, 3, 1, [-0.79, 2.1].+deltz, [0.00485, 0.046,  0.84,  8.3],    [-0.78, -0.24, 0.73, 2.7].+deltz)
nGum(0.91, 2, 2, Float64[],           [0.015,   0.15,   0.395, 0.087],  [0.85,   1.55, 2.65, 4.3].+deltz)

3.116080e-06
nGum(1.0490834015563657, 1, 1, Float64[], [-0.00017859313088673543, 0.06719217805673279, 0.15020850059663993, 0.024842335353985587], [1.7858206112831703, 3.153598722658457, 3.6420209901501552, 4.859363683114928])
nGum(1.106074113457539, 2, 1, [1.9471676972826293], [0.09400807798344114, 0.6824603070313886, 3.033649900828044, 0.47977402768573996], [0.6446742602242589, 1.3436525815851537, 2.372353871050142, 4.409286263909482])
nGum(0.8052734634825014, 3, 1, [-1.1898822328194112, 1.9321916302930247], [0.006130581809672791, 0.03016191470495937, 0.43315053244280033, 6.04773322486114], [-1.080278658560342, -0.44833816865727893, 0.46444741313088495, 2.4749308455825316])
nGum(0.820001305179561, 2, 2, Float64[], [0.0045894924981994545, 0.18114854602349523, 0.5959928960373214, 0.0709356366021927], [0.512183144982496, 1.351216582276122, 2.542928333366388, 4.327543552598081])

begin
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), Optim.Options(g_tol=1e-12, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar_res, NelderMead(), Optim.Options(g_tol=1e-12, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       results = optimize(x -> f_opt(x, fixparams...) - Elim, xar_res, NelderMead(), Optim.Options(g_tol=1e-12, iterations=20_000, show_trace=true, show_every=10))
       xar_res = results.minimizer
       x_res = get_x(results.minimizer, fixparams[1:2]...)
end

nSig_opt(1, 1, Float64[],          [1,1,1,1], [1,1,1,1])
nSig_opt(1, 1, [1],                [1,1,1,1], [1,1,1,1])
nSig_opt(1, 1, [1, 1],             [1,1,1,1], [1,1,1,1])
nSig_opt(1, 1, Float64[],          [1,1,1,1], [1,1,1,1])
nSig_opt(1, 1, [1],                [1,1,1,1], [1,1,1,1])

nSig_opt(0, 0, Float64[],          [0,0,0], [0,0,0])
nSig_opt(0, 0, [0],                [0,0,0], [0,0,0])
nSig_opt(0, 0, [0, 0],             [0,0,0], [0,0,0])
nSig_opt(0, 0, Float64[],          [0,0,0], [0,0,0])
nSig_opt(0, 0, [0],                [0,0,0], [0,0,0])

nSig(1, 1, 1, 2, Float64[],          [0.2, 0.5,  1.0,  0.5], [2.4, 3.4, 4.4, 5.4])
nSig(2, 1, 1, 2, [2.8],              [0.2, 0.5,  1.0,  0.5], [1.0, 2.0, 3.0, 4.0])
nSig(3, 1, 1, 2, [0.38, 2.8],        [0.2, 0.5,  1.0,  0.5], [0.2, 1.2, 2.2, 3.2])
nSig(2, 2, 1, 2, Float64[],          [0.2, 0.5,  1.0,  0.5], [1.0, 2.0, 3.0, 4.0])
nSig(3, 2, 1, 2, [0.97],             [0.2, 0.5,  1.0,  0.5], [0.2, 1.2, 2.2, 3.2])

nSig_opt(1, 1, Float64[],          [1], [1])
nSig_opt(1, 1, [1],                [1], [1])
nSig_opt(1, 1, [1, 1],             [1], [1])
nSig_opt(1, 1, Float64[],          [1], [1])
nSig_opt(1, 1, [1],                [1], [1])

nSig(1, 1, 1, 1, Float64[],          [1], [4])
nSig(2, 1, 1, 1, [2.8],              [1], [4])
nSig(3, 1, 1, 1, [0.38, 2.8],        [1], [4])
nSig(2, 2, 1, 1, Float64[],          [1], [4])
nSig(3, 2, 1, 1, [0.97],             [1], [4])

op0 = [
    nSig_opt(0, 0, Float64[],          [0], [0])
    nSig_opt(0, 0, [0],                [0], [0])
    nSig_opt(0, 0, [0, 0],             [0], [0])
    nSig_opt(0, 0, Float64[],          [0], [0])
    nSig_opt(0, 0, [0],                [0], [0])
]
nsum = 4
op0 = [
    nSig_opt(0, 0, Float64[], zeros(nsum), zeros(nsum))
    nSig_opt(0, 0, [0],       zeros(nsum), zeros(nsum))
    nSig_opt(0, 0, [0, 0],    zeros(nsum), zeros(nsum))
    nSig_opt(0, 0, Float64[], zeros(nsum), zeros(nsum))
    nSig_opt(0, 0, [0],       zeros(nsum), zeros(nsum))
]
optopt = Optim.Options(g_tol=5e-13, iterations=20_000, show_trace=true, show_every=10)
begin
    op = copy(op0)
    op[1] = nSig_opt(1,1,[],   ones(nsum),ones(nsum))
    op[2] = nSig_opt(1,1,[1],   ones(nsum),ones(nsum))
    op[3] = nSig_opt(1,1,[1,1],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
    op = copy(op0)
    op[4] = nSig_opt(1,1,[],   ones(nsum),ones(nsum))
    op[5] = nSig_opt(1,1,[1],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
end
begin
    op = copy(op0)
    op[1] = nSig_opt(1,1,[],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
    op = copy(op0)
    op[2] = nSig_opt(1,1,[1],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
    op = copy(op0)
    op[3] = nSig_opt(1,1,[1,1],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
    op = copy(op0)
    op[4] = nSig_opt(1,1,[],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
    op = copy(op0)
    op[5] = nSig_opt(1,1,[1],   ones(nsum),ones(nsum))
    f_opt, xar0, fixparams, get_x = make_f(qt,x0,op,ζ,ne)
    results = optimize(x -> f_opt(x, fixparams...) - Elim, xar0, NelderMead(), optopt)
    xar_res = results.minimizer
    x0 = get_x(results.minimizer, fixparams[1:2]...)
end

op = [
    nSig_opt(1, 1, Float64[], [1,1,1,1], [1,1,1,1])
    nSig_opt(1, 1, [1],       [1,1,1,1], [1,1,1,1])
    nSig_opt(1, 1, [1, 1],    [1,1,1,1], [1,1,1,1])
    nSig_opt(1, 1, Float64[], [1,1,1,1], [1,1,1,1])
    nSig_opt(1, 1, [1],       [1,1,1,1], [1,1,1,1])
]

x0 =[
nSig(1, 1, 1, 2, Float64[], [0.001, 0.1, 0.8, 0.1], [2.8, 3.8, 4.4, 5.5])
nSig(2, 1, 1, 2, [2.8161776619660666], [0.039985457349461774, 0.5583598194940049, 1.3400012020115484, 0.1778366764834064], [1.7136448764953214, 2.3496444921081747, 3.4221370017188355, 5.32794840481829])
nSig(3, 1, 1, 2, [0.38096503308607804, 2.7880905355335104], [0.0004739345858995951, 0.011228751793064871, 0.2733708855751731, 0.9838520887401521], [0.13737541485733049, 0.8020642622297137, 1.7842595396312382, 3.6490999840078913])
nSig(2, 2, 1, 2, Float64[], [0.0318135028929959, 0.37717985368587387, 0.5556218627876994, 0.10870037862270177], [1.7084251425965418, 2.3825924661655233, 3.4458544414563663, 5.043195392253833])
nSig(3, 2, 1, 2, [0.9702917893639799], [0.009694360155368998, 0.22579014438702533, 2.9747603013491344, 6.63035994574347], [-0.580341188285041, 0.31435354060872683, 1.3355512318261205, 3.1763287185913396])
]

x0 =[
nSig(1, 1, 1.024409062612785,  2, Float64[], [0.00016978454993833302, 0.1306227041119264, 0.7932016322785495, 0.07597871891010537], [2.1525272059745344, 3.8904065652589614, 4.4035948041298, 5.564056829177059])
nSig(2, 1, 1.1072548813682215, 2, [2.8161776619660666], [0.039985457349461774, 0.5583598194940049, 1.3400012020115484, 0.1778366764834064], [1.7136448764953214, 2.3496444921081747, 3.4221370017188355, 5.32794840481829])
nSig(3, 1, 0.8765395085116796, 2, [0.38096503308607804, 2.7880905355335104], [0.0004739345858995951, 0.011228751793064871, 0.2733708855751731, 0.9838520887401521], [0.13737541485733049, 0.8020642622297137, 1.7842595396312382, 3.6490999840078913])
nSig(2, 2, 1.0021857593894976, 2, Float64[], [0.0318135028929959, 0.37717985368587387, 0.5556218627876994, 0.10870037862270177], [1.7084251425965418, 2.3825924661655233, 3.4458544414563663, 5.043195392253833])
nSig(3, 2, 0.9484054253248536, 2, [0.9702917893639799], [0.009694360155368998, 0.22579014438702533, 2.9747603013491344, 6.63035994574347], [-0.580341188285041, 0.31435354060872683, 1.3355512318261205, 3.1763287185913396])
]

5.940202e-07
qt = [
    ETabn(-5,20,50),                                     
    ETabn(-5,15,40)
]

x0 =[
    nSig(1, 1, 1.0365784088433274, 3.8150551347776744, Float64[], [0.00033862572556164647, 0.24543637463834458, 0.6894174849904949, 0.0648075146455989], [2.206237425981342, 4.065530527822011, 4.453079957096864, 5.728729852070398])
    nSig(2, 1, 1.5669480584561304, 1.7490056920912551, [2.8322903412532456], [0.11830959926392724, 0.23722805853018833, 0.6021812056859804, 0.042281136519904006], [1.839794694641859, 2.362445006906115, 3.2173130254257702, 5.478740717185182])
    nSig(3, 1, 1.698481846804568, 1.779144410235933, [0.3930587488969742, 2.8279901800024185], [0.0007941790071178813, 0.020025729257945716, 0.25320237447307736, 0.725977717261859], [-0.5843060323290029, 0.26730444288023614, 1.2116741689805468, 2.816260098062507])   
    nSig(2, 2, 1.1766366735590132, 1.975965558982906, Float64[], [1.539792006781062e-5, 0.3216105006466396, 0.5225937215945681, 0.15578037983872445], [-0.5089711026297582, 2.258564959459277, 3.387512763933061, 5.004620136233537])
    nSig(3, 2, 1.8014654944994892, 1.5388582671001614, [1.0786413256848266], [0.002223771477846424, 0.04584169980836156, 0.43864038295435076, 0.5132941457594413], [-1.1482419256501508, -0.22170184019066566, 0.7252995581893513, 2.7574516873073835])
]

deltz = +2*log(17/18)
qt = [
    ETabn(-5+deltz,20,50),                                     
    ETabn(-5+deltz,15,40)
]

deltz = +2*log(17/18)
x0 =[
    nSig(1, 1, 1.0365784088433274, 3.8150551347776744, Float64[],                                       [0.00033862572556164647, 0.24543637463834458, 0.6894174849904949, 0.0648075146455989], [2.206237425981342, 4.065530527822011, 4.453079957096864, 5.728729852070398].+deltz)
    nSig(2, 1, 1.5669480584561304, 1.7490056920912551, [2.8322903412532456].+deltz,                     [0.11830959926392724, 0.23722805853018833, 0.6021812056859804, 0.042281136519904006], [1.839794694641859, 2.362445006906115, 3.2173130254257702, 5.478740717185182].+deltz)
    nSig(3, 1, 1.698481846804568,  1.779144410235933,  [0.3930587488969742, 2.8279901800024185].+deltz, [0.0007941790071178813, 0.020025729257945716, 0.25320237447307736, 0.725977717261859], [-0.5843060323290029, 0.26730444288023614, 1.2116741689805468, 2.816260098062507].+deltz)
    nSig(2, 2, 1.1766366735590132, 1.975965558982906,  Float64[],                                       [1.539792006781062e-5, 0.3216105006466396, 0.5225937215945681, 0.15578037983872445], [-0.5089711026297582, 2.258564959459277, 3.387512763933061, 5.004620136233537].+deltz)
    nSig(3, 2, 1.8014654944994892, 1.5388582671001614, [1.0786413256848266].+deltz,                     [0.002223771477846424, 0.04584169980836156, 0.43864038295435076, 0.5132941457594413], [-1.1482419256501508, -0.22170184019066566, 0.7252995581893513, 2.7574516873073835].+deltz)
]

x0 =[
    nSig(1, 1, 1.037776874363138,  3.5, Float64[], [0.00013861623343809743, 0.10169600038383528, 0.25305991151097, 0.027276709544310874], [1.9746084639644148, 3.8805559310074513, 4.354501702312852, 5.596169622970401])
    nSig(2, 1, 1.0884870890369094, 3.5, [2.6909713401490905], [0.04193646369801634, 0.5020537350854865, 1.3540248363593808, 0.21087412664739247], [1.6223293382309993, 2.241410907257396, 3.329791713397741, 5.144816933238555])
    nSig(3, 1, 0.8659699864335028, 3.5, [0.20314320547497597, 2.668120929113391], [0.0005139119151314762, 0.011366497369528298, 0.27251556707812763, 1.1181277634086684], [-0.008461833430041412, 0.6341192004065005, 1.6151510808993153, 3.4907469113353202])
    nSig(2, 2, 0.9931715108370172, 3.5, Float64[], [0.028766749064084888, 0.33033064687098157, 0.5333475001905412, 0.10909456107943008], [1.5608548558290212, 2.233936113133386, 3.3020647124742637, 4.882063353914733])
    nSig(3, 2, 0.8432748059571739, 3.5, [0.647494931306578], [0.002224086590068394, 0.04467208372844291, 0.6234434509655197, 1.9265466215689095], [-0.3775480629277108, 0.5244903062721005, 1.57723026771834, 3.1548181732605998])
]

x0 =[
nSig(1, 1, 1.024409062612785,  2, Float64[], [0.00016978454993833302, 0.1306227041119264, 0.7932016322785495, 0.07597871891010537], [2.1525272059745344, 3.8904065652589614, 4.4035948041298, 5.564056829177059])
nSig(2, 1, 1.1072548813682215, 2, [2.8161776619660666], [0.039985457349461774, 0.5583598194940049, 1.3400012020115484, 0.1778366764834064], [1.7136448764953214, 2.3496444921081747, 3.4221370017188355, 5.32794840481829])
nSig(3, 1, 0.8765395085116796, 2, [0.38096503308607804, 2.7880905355335104], [0.0004739345858995951, 0.011228751793064871, 0.2733708855751731, 0.9838520887401521], [0.13737541485733049, 0.8020642622297137, 1.7842595396312382, 3.6490999840078913])
nSig(2, 2, 1.0021857593894976, 2, Float64[], [0.0318135028929959, 0.37717985368587387, 0.5556218627876994, 0.10870037862270177], [1.7084251425965418, 2.3825924661655233, 3.4458544414563663, 5.043195392253833])
nSig(3, 2, 0.9484054253248536, 2, [0.9702917893639799], [0.009694360155368998, 0.22579014438702533, 2.9747603013491344, 6.63035994574347], [-0.580341188285041, 0.31435354060872683, 1.3355512318261205, 3.1763287185913396])
]